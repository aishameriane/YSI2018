---
title: "Artigo YSIS - Política Monetária x Desigualdade"
author: "Aishameriane Schmidt"
date: "Abril 2018"
header-includes:
   - \usepackage{bigints}
   - \usepackage[brazil]{babel}
   - \usepackage{graphicx}
   - \usepackage{amsmath}
output: html_document
---
# Dúvidas pra ver com o Guilherme

Dúvidas em <span style="color:blue">**azul**</span> eu acho que já entendi, mas deixei aqui a resposta para que a Aisha do futuro possa consultar também. Dúvidas em <span style="color:red">**vermelho**</span> ainda precisam de resposta.

1.  <span style="color:red">**Dúvidas de tradução:**</span> 

<span style="color:green">**Resposta**</span>:
* _u.m.c. milhão_ (é a unidade que o Bacen usa para algumas variáveis)
* _variação % mensal_ (tipo quando pega o PIB e calcula o de hoje menos o de ontem dividido pelo de ontem)
* _IPCA_ - **price index** ou **inflation rate** ?
* _BM\&FBOVESPA S.A. - Bolsa de Valores, Mercadorias e Futuros (BM\&FBOVESPA)_
* Capital income 
* Labor income
* Capital-Labor ratio
* Interest rate (o que fazer com SELIC, deixo SELIC mesmo?)
* 3 month treasury bill rate
* Price index ou Inflation rate?
* Real Effective Interest Rate Index (Índice da Taxa de Câmbio Efetiva Real)
* Precisa traduzir as fontes dos dados? Por exemplo, Banco Central departamento de estatísticas ou a Bovespa?

2.  <span style="color:blue">**Dúvida 2:**</span> Queria discutir sobre raizes unitárias...
* Como o modelo é TVP, por construção ele não "acredita" em uma distribuição estacionária?

<span style="color:green">**Resposta**</span>: Isso também. Mas o fato de usar um passeio aleatório como lei de movimento dos coeficientes naturalmente impõe uma estrutura não estacionária no modelo.

2. 1. <span style="color:red">**Dúvida 2:**</span> Tá, mas aí como que a gente faz com a função impulso resposta? Pelo que eu entendo, a função impulso resposta usa os coeficientes calculados (no caso, estou usando a média) em um determinado $t$ para dar o choque em uma variável e ver o que ocorre com as demais, mas ele não muda os coeficientes... Como que fica isso? Eu fui procurar na documentação do pacote que estou usando como que é calculada a FIR. Tem três formas de fazer (eu estou usando a terceira, que é a mesma maneira do Primiceri e Del Negro (2015)). O modelo do Primideri para uma série temporal n-dimensional é dado por:

$$y_t = c_t + B_{1,t}\cdot y_{t-1} + \ldots + B_{p,t} \cdot y_{t-p} + A_t^{-1} \cdot \Sigma_t\cdot \varepsilon_t$$
(a especificação completa pode ser vista [aqui](https://github.com/FK83/bvarsv/blob/master/bvarsv_Nov2015_website.pdf)).

a. No primeiro cenário, a FIR é calculada considerando o vetor $u_t \equiv A_t^{-1} \cdot \Sigma_t\cdot \varepsilon_t$. A função estima qual o efeito de um choque de um desvio padrão em um dos elementos $u_t$ (i.e. $u_{t.j}=1$ e $u_{t,i}=0$, para todo $i \neq j$) afeta $y_{t+h}$, em comparação com $u_t$ sendo um vetor de zeros. Esta abordagem não é considerada realista pois usualmente $A_t^{-1} \cdot \Sigma_t$ não será uma matriz diagonal (os choques são correlacionados). Nesta abordagem, tanto os elementos de $c_t$ como de $B_{j,t}$ são mantidos fixos nos seus valores estimados para $t$;
b. No segundo cenário, a FIR estima o impacto de uma unidade em algum dos elementos de $\varepsilon_t$. Os elementos de $c_t$, $B_{j,t}$, $A_t$ e $\Sigma_t$ são mantidos fixos nos seus valores estimados para $t$. Esta abordagem depende da ordem das variáveis.
c. O cenário 3 é igual ao cenário dois mas os elementos de $\Sigma_t$ são substituídos pela média dos valores em todos os períodos. Esta forma é a que foi utilizada por Primiceri em 2005 e Primiceri e Del Negro em 2015.

Na prática o que o algoritmo faz é calcular a FIR para cada uma das estimativas obtidas pelo algoritmo MCMC e então calcula a média e os quantis desses valores.

<span style="color:green">**Resposta**</span>: 

3.  <span style="color:red">**Dúvida 3:**</span> Sobre o X-13 ARIMA SEATS. Tem uma opção de usar uma transformação nos dados antes de ajustar o modelo SARIMA. O que o procedimento faz é uma transformação Box-Cox. Mas daí a minha dúvida é o seguinte: em geral o modelo testa se deve fazer o log versus fazer nada (o default é esse). Só que a série sem sazonalidade, quando plotada contra a série original está sempre na mesma escala (e no caso do PIB, que tem tendência, o bicho continua com tendência). Essa transformação de log é o quê, então?

Eu li e não achei resposta pra isso:

* Cap 3 do DeJong,
* http://documentation.sas.com/?docsetId=etsug&docsetTarget=etsug_x13_syntax20.htm&docsetVersion=14.2&locale=en,
* https://www.imf.org/external/pubs/ft/qna/pdf/2017/chapter7.pdf (ver nota de rodapé 14 na página 10)
* https://www.census.gov/ts/papers/gettingstartedx13acc_winx13.pdf (ver página 6)
* ftp://ftp.ibge.gov.br/Contas_Nacionais/Contas_Nacionais_Trimestrais/Ajuste_Sazonal/X13_NasContasTrimestrais.pdf
* https://usefulr.wordpress.com/2014/02/17/adjusting-chinese-new-year-effects-in-r-is-easy/

O pouco que eu acho que entendi é que a função por default usa um critério (baseado na verossimilhança) para definir se o modelo SARIMA ajustado é multiplicativo ou aditivo. Mas isso ainda não me ajuda a entender porque a escala da variável dessazonalizada não é em log, então alguma coisa ainda está confusa...

<span style="color:green">**Resposta**</span>: 

4.  <span style="color:red">**Dúvida 4:**</span> Quando mudei a taxa de câmbio para taxa real efetiva, as funções impulso resposta do Câmbio sobre a razão capital trabalho passaram a ser significativas. Porém, está com sentido de que "aumentos na taxa de câmbio aumentam a razão capital trabalho". Só que é o mesmo formato que a taxa de juros tem, "choque positivo nos juros, aumenta a razão capital-trabalho". O problema está em eu esperar que juros e câmbio tenham relação inversa, isto é, eu esperaria que um aumento na taxa de juros fizesse o câmbio diminuir - *se o juros aumenta fica mais interessante para investimentos estrangeiros e com isso há um aumento de moeda estrangeira fazendo com que a taxa de câmbio fique menor* - então se juros alto $\Rightarrow$ câmbio baixa, eu esperaria que a relação que cada um deles tem com a razão capital trabalho fosse invertida. 

Por outro lado, se a taxa de câmbio aumenta, os investimentos em moeda estrangeiro ficam mais rentáveis e os rendimentos do capital ficariam maiores, pensando exclusivamente em capital financeiro. Mas se pensar em termos de capital físico, se uma pessoa precisa importar uma máquina de sorvete (de ANDRADE, C.R., 2018) e o câmbio aumentou, ela vai precisar gastar mais dinheiro para comprar a máquina. Por outro lado, quem exporta, vai ganhar mais. Argh. ~~Merda de economia aberta~~.

<span style="color:green">**Resposta**</span>: 

5.  <span style="color:red">**Dúvida 5:** </span> Eu estou com problema para interpretar o coeficiente do PIB defasado na equação dele, pois está negativo. Isso quer dizer que quanto maior a taxa de variação em $t-1$, *menor* será a taxa de variação em $t$?

<span style="color:green">**Resposta**</span>:

6.  <span style="color:red">**Dúvida 6:** </span> Na [documentação do pacote](https://github.com/FK83/bvarsv/blob/master/bvarsv_Nov2015_website.pdf), na parte de previsão, ele calcula algo que ele chama de média condicional aos parâmetros ($\mu_{T+j}^{(\ell)}$). Isso seria como a média incondicional do modelo naquele instante? Tô meio confusa, porque o modelo não é estacionário... ![C:/Users/aisha/Pictures/hmm.jpg]\

<span style="color:green">**Resposta**</span>: 

7.  <span style="color:red">**Dúvida 7:** </span> Com relação ao MAPE e MSE, eu calculo para cada variável individualmente, correto? Não é tipo uma medida "global"...?

<span style="color:green">**Resposta**</span>: 

# Introduction

This code has all the calculations used in the work _"The Impact of Monetary Policy on Income Inequality: Evidences from Brazilian Economy"_. It is divided in three parts: the first one deals with data preparation and some descriptive statistics; second part estimates a VAR model and third part assess the convergence diagnostics for the MCMC algorithm.

To estimate the VAR model, I used the [`bvarsv`](https://cran.r-project.org/web/packages/bvarsv/index.html) do [Fabian Kruger](https://sites.google.com/site/fk83research/papers) package. This two files are very helpful: [bvarsv: An R implementation of the Primiceri (2005) model for macroeconomic time series](https://github.com/FK83/bvarsv/blob/master/bvarsv_Nov2015_website.pdf) and [Replication of figures in Del Negro and Primiceri (2015)](https://github.com/FK83/bvarsv/blob/master/bvarsv_replication.pdf). For the diagnostics, I used the `coda` package.

## Downloading packages

If mirror 10 ("UFRJ") is offline, try changing `ind = 10` to `ind = 1`. Do the same thing if you get an error installing the `BETS` package.

```{r, warning = FALSE, message = FALSE}
chooseCRANmirror(graphics = FALSE, ind = 10)
if (!require("pacman")) install.packages("pacman")
pacman::p_load(devtools, ggplot2, forecast, BETS, seasonal, seasonalview, bvarsv, lubridate, zoo, stargazer, gridExtra, reshape2, ggfortify, RColorBrewer, scales, quantmod, PerformanceAnalytics, strucchange, coda, foreach, doParallel, knitr, grid, ggpubr, gdata, vars, urca, compiler, DescTools) 
```

These are some auxiliary functions used later in the code (I took them from `bvarsv` documentation):

```{r, warning = FALSE, message = FALSE}
## Some graphical parameters
matplot2 <- function(...){
  matplot(..., type = 'l', lty = 1, lwd = 2, bty = "n", ylab = "")
}

# Stat.helper calculates que quantiles and organizes them in quantile 1, mean, quantile 3 given a vector z
stat.helper <- function(z) c(mean(z), quantile(z, c(0.16, 0.84)))[c(2,1,3)]

# Color palette
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

cols1 <- cbPalette[c(2,4,2)]
cols2 <- cbPalette[c(2,4,6)]

# This one is for IRF analysis
stat.helper2 <- function(z) c(mean(z), quantile(z, c(0.05, 0.25, 0.75, 0.95)))[c(2, 3, 1, 4, 5)]
```

# Data handling

## Downloading data

All data was obtained from Brazil's Central Bank repository (Sistema Gerenciador de Séries do Banco Central - SGS). The following series were used (obs: beginning and end of the series corresponds to the available data, not actual data used in the work and some data were manipulated, for example interest rate were converted to annual - mannipulations are described in code and in the paper appendix):

* **Receitas tributárias - Regime de competência - Imposto de renda - Retido na fonte - Rendimento do trabalho** (_Labor Income_)
    * **Beginning of the series:** January, 1992. 
    * **End of the series:** February, 2018. 
    * **Unity:** u.m.c. milhões. 
    * **Series number in SGS:** 7620. 
    * **Source:** Brazil's Central Bank - Statistics Department (BCB-DSTAT).
    
* **Receitas tributárias - Regime de competência - Imposto de renda - Retido na fonte - Rendimento do capital** (_Capital Income_)
    * **Beginning of the series:** January, 1992. 
    * **End of the series:** February, 2018. 
    * **Unity:** u.m.c. milhões. 
    * **Series number in SGS:** 7621. 
    * **Source:** Brazil's Central Bank - Statistics Department (BCB-DSTAT).

* **Taxa de Juros - Selic** (_Interest Rate_)
    * **Beginning of the series:** July, 1986. 
    * **End of the series:** April, 2018. 
    * **Unity:** % monthly. 
    * **Series number in SGS:** 4390. 
    * **Source:** Brazil's Central Bank - Open Market Operations Department (BCB-Demab).
    
* **Taxa referencial de swaps DI pré-fixada (BM\&F) - Prazo de 90 dias (fim de período)** (_3-month treasury bill rate_)
    * **Beginning of the series:** September, 1999. 
    * **End of the series:** March, 2018. 
    * **Unity:** % annual. 
    * **Series number in SGS:** 7818. 
    * **Source:** BM\&FBOVESPA S.A. - Bolsa de Valores, Mercadorias e Futuros (BM\&FBOVESPA).

* **Índice nacional de preços ao consumidor-amplo (IPCA)** (_Price index_)
    * **Beginning of the series:** January, 1980. 
    * **End of the series:** March, 2018. 
    * **Unity:** Percent monthly variation. 
    * **Series number in SGS:** 433 
    * **Source:** Brazilian Institute of Geography and Statistics (IBGE).

* **Monthly GDP** 
    * **Beginning of the series:** January, 1990. 
    * **End of the series:** February, 2018. 
    * **Unity:** Brazilian Real (R$) - millions. 
    * **Series number in SGS:** 4380 
    * **Source:** Brazil's Central Bank - Economic Department (BCB-Depec).
    
* **Interest Rate - USD Dollar (sell) - End of Period - Monthly** - ANTIGO
    * **Beginning of the series:** January, 1953. 
    * **End of the series:** March, 2018. 
    * **Unity:** u.m.c./US$. 
    * **Series number in SGS:** 3696. 
    * **Source:** Brazil's Central Bank - Sisbacen PTAX800.

* **Real Effective Interest Rate Index - Monthly** 
    * **Beginning of the series:** January, 1988. 
    * **End of the series:** March, 2018. 
    * **Unity:** Index (100 = Jun/1994). 
    * **Series number in SGS:** 11752 
    * **Source:** Brazil's Central Bank - Statistics Department (BCB-DSTAT).


Obs: Para ver o ADF, usei isso aqui: https://stats.stackexchange.com/questions/24072/interpreting-rs-ur-df-dickey-fuller-unit-root-test-results

## Downloading the data


```{r, message = FALSE, warning = FALSE}
# Auxiliary variables, so I don't need to bother when something changes
inicio <- "1996-01-01"
fim    <- "2018-02-28"
inicio_deflator <- "1993-12-31"
inicio_swap     <- "1999-09-01"

# Don't mess with this code
inicio_cambio <- paste(seq(as.Date(inicio), length = 2, by = "-1 month")[2]) # 1 month before the beginning of the other series
inicio_ipca2   <- paste(seq(as.Date(inicio), length = 12, by = "-1 month")[12]) # 12 months before the beginning of the other series
fim_ipca      <- paste(seq(as.Date(fim), length = 2, by = "1 month")[2]) # 1 month after the end of the other series
inicio_swap2 <- paste(seq(as.Date(inicio_swap), length = 2, by = "-1 month")[2]) # 1 1 month before the beginning of the other series

## Obs: In case you have a SQL problem, rollback this two packages and mannually download BETS from CRAN and reinstall it as well
## See: https://stackoverflow.com/questions/43073782/rmysql-system-error-10060 and https://github.com/pedrocostaferreira/BETS/issues/29
# require(devtools)
# install_version("DBI", version = "0.5", repos = "http://cran.us.r-project.org")
# install_version("RMySQL", version = "0.10.9", repos = "http://cran.us.r-project.org")

################################
##### Capital labor ratio ######
################################

trabalho <- BETS.get("7620", from = inicio, to = fim)
capital  <- BETS.get("7621", from = inicio, to = fim)
capital_trabalho <- capital/trabalho

########################
##### Price Index ######
########################

ipca_raw <- BETS.get("433", from = inicio_deflator, to = fim_ipca) 
ipca2 <- ipca_raw
ipca2[1] <- 100

# The following calculation was made following IPEA methodology: http://www.ipeadata.gov.br/iframe_transformacao.aspx?width=1474&height=701
# Transforms in index
for (i in 2:length(ipca2)){
  ipca2[i] <- round(ipca2[(i-1)]*(1+ipca2[(i)]/100),2)
}

# Geometric Average
for (i in 1:(length(ipca2)-1)){
  ipca2[i] <- sqrt(ipca2[i]*ipca2[(i+1)])
}

# Change base to mar/2018
for (i in 1:length(ipca2)) {
  ipca2[i] <- tail(ipca2, n=2)[1]/ipca2[i]
}

# Elimitates data outside the period we are studying
ipca2 <- ts(ipca2,  start = c(1993, 12, 31), frequency = 12)
ano_ipca <- as.numeric(substr(inicio_cambio, start = 1, stop = 4))
mes_ipca <- as.numeric(substr(inicio_cambio, start = 6, stop = 7))
ipca2 <- window(ipca2, c(ano_ipca, mes_ipca))

ano_ipca <- as.numeric(substr(inicio_ipca2, start = 1, stop = 4))
mes_ipca <- as.numeric(substr(inicio_ipca2, start = 6, stop = 7))
ipca_raw <- window(ipca_raw, c(ano_ipca, mes_ipca))

# Removes last observation
ipca_raw <- ipca_raw[1:(length(ipca_raw)-1)]

ipca_acum <- ipca_raw/100 + 1
ipca <- vector()

final <- length(ipca_acum)
for (i in 12:final){
  ipca[(i-11)] <- (prod(ipca_acum[(i-11):i])-1)*100
}

ano <- as.numeric(substr(inicio, start = 1, stop = 4))
mes <- as.numeric(substr(inicio, start = 6, stop = 7))
dia <- as.numeric(substr(inicio, start = 9, stop = 10))

ipca <- ts(ipca,  start = c(ano, mes, dia), frequency = 12) # Date format YYYY MM DD

################
##### GDP ######
################

PIBmensal <- BETS.get("4380", from = inicio_cambio, to = fim)
PIBmensal <- PIBmensal * ipca2 

##########################
##### Exchange rate ######
##########################

# Antigo câmbio nominal
#cambio_raw <- BETS.get("3696", from = inicio_cambio, to = fim)
cambio_raw <- BETS.get("11752", from = inicio, to = fim) # Since this is already an index, I don't need to take the log-diff

###########################
##### Interest rates ######
###########################

selic_4390 <- BETS.get("4390", from = inicio, to = fim)
# Transforms into anual rate
selic <- ((1+selic_4390/100)^(12)-1)*100

swap90 <- BETS.get("7818", from = inicio_swap, to = fim)
```

## Visualizing data

```{r, message = FALSE, echo = FALSE, warning = FALSE}
# Make dummy observations to complete the swap series - I need to plot the graph. Later I'll drop, treat seasonality and merge with selic
dummy <- ts(rep(0, length(seq(from = as.Date(inicio), to = as.Date(inicio_swap2), by = "1 month"))),  start = c(1996, 01, 01), frequency = 12)
## Binding the series
comb <- ts.union(dummy, swap90)
swap <- pmin(comb[,1], comb[,2], na.rm = TRUE)
swap[1:44] <- NA

# Plotting some nice graphs
## First, creates a data frame
df1 <- data.frame(seq(as.Date(inicio), length = length(ipca), by = "1 month"), capital_trabalho, swap, selic, round(PIBmensal[2:length(PIBmensal)]/10^5,2), cambio_raw, ipca)
names(df1) <- c("Data", "Capital_trabalho", "swap", "selic", "PIB", "Cambio",  "IPCA")
df2 <- melt(data = df1, id.vars = "Data")

cores <- brewer.pal(6, "Dark2")

## Individual Graphs
### Capital-Labor Ratio
p1ori <- ggplot(df2[which(df2$variable == "Capital_trabalho"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="Capital trabalho\n ") +
        scale_x_date(date_breaks = "24 months")+ 
        theme_bw()
p1ori <- p1ori + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

### Swap (interest rate)
p2ori <- ggplot(df2[which(df2$variable == "swap"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[5])+
        scale_y_continuous(name="Swap\n (%a.a)") +
        scale_x_date(date_breaks = "24 months")+
        theme_bw()
p2ori <- p2ori + theme(axis.text.y = element_text(size=6), axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

### GDP
p3ori <- ggplot(df2[which(df2$variable == "PIB"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[3])+
      scale_y_continuous(name=expression(paste("PIB mensal", x10^{-5}, " \n"))) +
        scale_x_date(date_breaks = "24 months", name = "Data", labels = date_format("%Y"))+
        theme_bw()
p3ori <- p3ori + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

## Exchange rate
p4ori <- ggplot(df2[which(df2$variable == "Cambio"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[4])+
        scale_y_continuous(name="Tx. Câmbio (índice)") +
        scale_x_date(date_breaks = "24 months", name = "Data", labels = date_format("%Y"))+
        theme_bw()
p4ori <- p4ori + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

## Price Index (IPCA)
p6ori <- ggplot(df2[which(df2$variable == "IPCA"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[6])+
        scale_y_continuous(name="IPCA\n (acum. 12m.)") +
        scale_x_date(date_breaks = "24 months", name = "Data", labels = date_format("%Y"))+
        theme_bw()
p6ori <- p6ori + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

grid.arrange(p1ori, p6ori, p3ori, p2ori, p4ori, ncol=1, nrow = 5)
```

## Treating for seasonality and structural breaks

The output of the seasonality tests will appear. The analysis is hidden inside the code.

### 1. Capital-Labor Ratio

```{r, warning = FALSE, message=FALSE}

# Calculates the structural breaks
bp_ts <- breakpoints(capital_trabalho ~ 1)
ci_ts <- confint(bp_ts)

# Monthplot aggregates days and months and takes averages
meses <- ggmonthplot(capital_trabalho) + 
  theme_bw() +
  #scale_y_continuous(name = "Capital-Labor Ratio (% - average)") +
  scale_y_continuous(name = "Razão capital-trabalho (%)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Média diária e mensal da razão capital-trabalho", x = "Mês", subtitle = "Nenhuma transformação")
  #labs(title = "Daily and monthly averages of Capital-Labor ratio", x = "Month", subtitle = "No data transformation")

# Seasonplot has the averages for month, each line represents a year
season <- ggseasonplot(capital_trabalho, year.labels = TRUE) + 
  geom_point() + 
  theme_bw() + 
  scale_y_continuous(name = "Razão capital-trabalho (%)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #scale_y_continuous(name = "Capital-Labor Ratio (% - average)") +
  #labs(title = "Monthly averages of Capital-Labor ratio", x = "Months", subtitle = "No data transformation")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Season_CT.pdf", width = 6, height = 3)
season
#dev.off()

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Month_CT.pdf", width = 6, height = 3)
meses
#dev.off()


Data <- seq(as.Date("1996-01-01"), length = length(capital_trabalho), by = "1 month")
df1 <- melt(data.frame(Data,capital_trabalho), id.vars = "Data")
names(df1) <- c("Data", "Variavel", "Valor")

# Graph with structural break (dashed) and CI (red)
p1 <- ggplot(df1[which(df1$Variavel == "capital_trabalho"),], aes(Data, Valor, colour = Variavel)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name = "Razão capital-trabalho (%)") +
        #scale_y_continuous(name="Capital-Labor ratio") +
        scale_x_date(date_breaks = "12 months", name = "Data", labels = date_format("%m-%Y"))+ 
        geom_vline(xintercept = Data[bp_ts$breakpoints], linetype="longdash")+
        geom_segment(aes(x = Data[ci_ts$confint[1]], y = min(capital_trabalho), xend = Data[ci_ts$confint[3]], yend = min(capital_trabalho)))+
        theme_bw()
p1 <- p1 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), legend.position = "none")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Quebra_CT.pdf", width = 6, height = 3)
p1
#dev.off()

# We divide the series in pieces (accordingly to the structural break)
capital_trabalho_a <- capital_trabalho[1:bp_ts$breakpoints]
capital_trabalho_b <- capital_trabalho[(bp_ts$breakpoints+1):length(capital_trabalho)]
capital_trabalho_a <- ts(capital_trabalho_a,  start = c(1996, 01, 01), frequency = 12)
capital_trabalho_b <- ts(capital_trabalho_b,  start = c(2004, 02, 01), frequency = 12)

m <- seas(x = capital_trabalho_a, transform.function = "none", regression.aictest = NULL)
#m <- seas(x = capital_trabalho_a, regression.aictest = NULL)

## First diagnostics is using qs() function to check for seasonality after the adjustment
qs(m)
# Click here to see the how the qs statistics is calculated: https://stats.stackexchange.com/questions/148573/the-results-and-specifics-from-the-qs-function-in-r
# The first 7 results are related to the whole series, the last 7 comprehends only the last 8 years
# qsori is the original series
# qsorievadj is the original series corrected for extreme values
# qsrsd is the residual's series of the ARIMA model
# qssadj is the series with seasonal adjustment 
# qssadjevadj is the series with seasonal adjustment corrected for extreme values
# qsirr is the series of the irregular component
# qsirrevadj is the series of the irregular component corrected for extreme values
# by the output, we can conclude that there is no evidence of seasonal components in the adjusted series, the residuals and the irregular component, even when we look just the last 8 years.

# Next step is to diagnose the pre-adjust and the ARIMA model
summary(m)
# We have an level-shift outlier in July, 1998 (Asian crisis?)
# We also have additive outliers in Jan96, Jan98, Aug98, Feb99, Mar99, Oct02
# The estimated model is an ARIMA (1 0 0)(0 1 1) with the non-seasonal AR significative and the MA seasonal significative.
capital_trabalho_2a <- final(m)

m <- seas(x = capital_trabalho_b, transform.function = "none", regression.aictest = NULL)

#m <- seas(x = capital_trabalho_b, regression.aictest = NULL) # se tomar o log, fica melhor
qs(m)
summary(m)
capital_trabalho_2b <- final(m)

###############
# Juntando novamente as duas séries
###############

comb <- ts.union(capital_trabalho_2a, capital_trabalho_2b)
capital_trabalho_final <- pmin(comb[,1], comb[,2], na.rm = TRUE)

# Compara a série ajustada com a série original
df <- data.frame(seq(as.Date("1996-01-01"), length = length(capital_trabalho_final), by = "1 month"), capital_trabalho, capital_trabalho_final)
names(df) <- c("Data", "Original", "Filtrada")
p1 <- ggplot(df, aes(Data)) +
  geom_line(aes(y = capital_trabalho, colour = "Original"), linetype = "dashed") +
  geom_line(aes(y = capital_trabalho_final, colour = "Filtrada")) + 
  scale_x_date(date_breaks = "12 months", name = "Ano", labels = date_format("%Y"))+
  scale_y_continuous(name = "Razão Capital/Trabalho (%)")+
  labs(color="Série") +
  scale_colour_manual("Variável", breaks = c("Original", "Filtrada"), values = c(cores[1], cores[2]))+
  theme_bw() + theme(axis.text.x = element_text(angle=30, hjust = 1, size = 7), legend.position = "top")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-AntesDepois_CT.pdf", width = 6, height = 3)
p1
#dev.off()



# Essa parte ficou de fora
# Now I'm going to test for unit roots and outliers

teste <- ur.df(capital_trabalho_final, type = "drift", lags = 20, selectlags = "AIC")
summary(teste)
# The value of -2.7642 indicates that we fail to reject the hypothesis of a unit root at 5% sig. level
# Let's take the first difference of this series
capital_trabalho_diff <- diff(capital_trabalho_final)
teste <- ur.df(capital_trabalho_diff, type = "drift", lags = 20, selectlags = "AIC")

# The test statistic of -10,74 makes clear that we reject the null hypothesis of unit root
summary(teste)

# Compara a série ajustada com a série original e a série diferenciada
df <- data.frame(seq(as.Date("1996-01-01"), length = length(capital_trabalho_final[1:(length(capital_trabalho_final)-1)]), by = "1 month"), capital_trabalho[1:(length(capital_trabalho)-1)], capital_trabalho_final[1:(length(capital_trabalho_final)-1)], capital_trabalho_diff)
names(df) <- c("Data", "Original", "Série Filtrada", "Série diferenciada")
p1 <- ggplot(df, aes(Data)) +
  geom_line(aes(y = capital_trabalho[1:(length(capital_trabalho)-1)], colour = "Original")) +
  geom_line(aes(y = capital_trabalho_final[1:(length(capital_trabalho_final)-1)], colour = "Filtrada")) + 
  geom_line(aes(y = capital_trabalho_diff, colour = "Diferenciada")) + 
  scale_x_date(date_breaks = "12 months", name = "Data", labels = date_format("%m-%Y"))+
  scale_y_continuous(name = "Razão Capital/Trabalho")+
  labs(color="Variável") +
  theme_bw() + theme(axis.text.x = element_text(angle=30, hjust = 1, size = 7))
p1

rm(capital_trabalho_a, capital_trabalho_b, capital_trabalho_2a, capital_trabalho_2b, p1, capital, trabalho, teste)
```

### 2. Selic (interest rate)

```{r, message = FALSE, warning = FALSE}
meses <- ggmonthplot(selic) + 
  theme_bw() +
  scale_y_continuous(name = "Selic (%a.a.)") +
  #labs(title = "Média diária e mensal da taxa Selic", x = "Mês", subtitle = "Nenhuma transformação")+
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))

# Gráfico por ano e mês
season <- ggseasonplot(selic, year.labels = TRUE) + 
  geom_point() + 
  theme_bw() + 
  scale_y_continuous(name = "Selic (%a.a.)") +
  #labs(title = "Média mensal da taxa Selic", x = "Mês", subtitle = "Nenhuma transformação")+
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Season_SELIC.pdf", width = 6, height = 3)
season
#dev.off()

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Month_SELIC.pdf", width = 6, height = 3)
meses
#dev.off()

bp_ts <- breakpoints(selic ~ 1)
ci_ts <- confint(bp_ts)

Data <- seq(as.Date("1996-01-01"), length = length(selic), by = "1 month")
df1 <- melt(data.frame(Data,selic), id.vars = "Data")
names(df1) <- c("Data", "Variavel", "Valor")

p1 <- ggplot(df1[which(df1$Variavel == "selic"),], aes(Data, Valor, colour = Variavel)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="Selic (%a.a.)") +
        scale_x_date(date_breaks = "12 months", name = "Data", labels = date_format("%m-%Y"))+ 
        geom_vline(xintercept = Data[bp_ts$breakpoints], linetype="longdash")+
        geom_segment(aes(x = Data[ci_ts$confint[1]], y = min(selic), xend = Data[ci_ts$confint[5]], yend = min(selic)))+
        geom_segment(aes(x = Data[ci_ts$confint[2]], y = min(selic), xend = Data[ci_ts$confint[6]], yend = min(selic)))+
        theme_bw()
p1 <- p1 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), legend.position = "none")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Quebra_SELIC.pdf", width = 6, height = 3)
p1
#dev.off()

###########
# Dividindo a selic em três pedaços
##########

# Salvando três séries para passar o seasonal
selic_a <- selic[1:(bp_ts$breakpoints[1]-1)]
selic_b <- selic[(bp_ts$breakpoints[1]):(bp_ts$breakpoints[2]-1)]
selic_c <- selic[(bp_ts$breakpoints[2]):(length(selic))]
selic_a <- ts(selic_a,  start = c(1996, 01, 01), frequency = 12)
selic_b <- ts(selic_b,  start = c(1999, 05, 01), frequency = 12)
selic_c <- ts(selic_c,  start = c(2006, 08, 01), frequency = 12)

selic_2a <- selic_a

m <- seas(x = selic_b, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)
selic_2b <- final(m)

m <- seas(x = selic_c, transform.function = "none", regression.aictest = NULL) 
qs(m)
summary(m)
selic_2c <- final(m)

###############
# Juntando novamente as três séries
###############

comb <- ts.union(selic_2a, selic_2b, selic_2c)
selic_final <- pmin(comb[,1], comb[,2], comb[,3], na.rm = TRUE)

# Compara a série ajustada com a série original
df <- data.frame(seq(as.Date("1996-01-01"), length = length(selic_final), by = "1 month"), selic, selic_final)
names(df) <- c("Data", "Original", "Série Filtrada")
p1 <- ggplot(df, aes(Data)) +
  geom_line(aes(y = selic, colour = "Original"), linetype = "dashed") +
  geom_line(aes(y = selic_final, colour = "Filtrada")) + 
  scale_x_date(date_breaks = "12 months", name = "Ano", labels = date_format("%Y"))+
  scale_y_continuous(name = "Selic (%a.a.)")+
  labs(color="Série") +
  scale_colour_manual("Variável", breaks = c("Original", "Filtrada"), values = c(cores[1], cores[2]))+
  theme_bw() + theme(axis.text.x = element_text(angle=30, hjust = 1, size = 7), legend.position = "top")
p1

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-AntesDepois_SELIC.pdf", width = 6, height = 3)
p1
#dev.off()

teste <- ur.df(selic_final, type = "drift", selectlags = "AIC", lags = 20)
summary(teste)
# Eu não acho que faz muito sentido diferenciar a selic pra tirar a raiz unitária... mas é uma possibilidade pra ver se são as variações na selic que impactam nas variações da razão capital trabalho

rm(p1, p2, selic_4390, selic_2a, selic_2b, selic_2c, selic_a, selic_b, selic_c, teste)
```

### 2. Swap DI pré 3 meses

```{r, message = FALSE, warning = FALSE}
meses <- ggmonthplot(swap90) + 
  theme_bw() +
  scale_y_continuous(name = "Swap DI 90d (%a.a)") +
  #labs(title = "Média diária e mensal da taxa Selic", x = "Mês", subtitle = "Nenhuma transformação")+
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))

# Gráfico por ano e mês
season <- ggseasonplot(swap90, year.labels = TRUE) + 
  geom_point() + 
  theme_bw() + 
  scale_y_continuous(name = "Swap DI 90d (%a.a.)") +
  #labs(title = "Média mensal da taxa swapDI 90d", x = "Mês", subtitle = "Nenhuma transformação")+
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Season_SWAP.pdf", width = 6, height = 3)
season
#dev.off()

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Month_SWAP.pdf", width = 6, height = 3)
meses
#dev.off()

bp_ts <- breakpoints(swap90 ~ 1)
ci_ts <- confint(bp_ts)

#m <- seas(swap90, transform.function = "none", regression.aictest = NULL)
#summary(m) # Series should not be a candidate for seasonal adjustment because the spectrum of the prior adjusted series (Table B1) has no visually significant seasonal peaks.

Data <- seq(as.Date("1999-09-01"), length = length(swap90), by = "1 month")
df1 <- melt(data.frame(Data,swap90), id.vars = "Data")
names(df1) <- c("Data", "Variavel", "Valor")

p1 <- ggplot(df1[which(df1$Variavel == "swap90"),], aes(Data, Valor, colour = Variavel)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="Swap DI 90d (%a.a.)") +
        scale_x_date(date_breaks = "12 months", name = "Data", labels = date_format("%m-%Y"))+ 
        geom_vline(xintercept = Data[bp_ts$breakpoints], linetype="longdash")+
        geom_segment(aes(x = Data[ci_ts$confint[1]], y = min(swap90), xend = Data[ci_ts$confint[5]], yend = min(swap90)))+
        geom_segment(aes(x = Data[ci_ts$confint[2]], y = min(swap90), xend = Data[ci_ts$confint[6]], yend = min(swap90)))+
        theme_bw()
p1 <- p1 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), legend.position = "none")
p1

## Cortar a selic a partir de 1999-09-01
selic_cortada <- window(selic_final, c(1999, 09))

df8 <- data.frame(Data, swap90, selic_cortada)
names(df8) <- c("Data", "Swap", "Selic")

df9 <- melt(data = df8, id.vars = "Data")

p9 <- ggplot(df9, aes(Data, value, colour = variable))+
  geom_line(alpha = 1, aes(linetype = variable))+
  labs(title="", y = "Taxa (%a.a.)", x = "Ano", color = "Taxa") +
  scale_colour_brewer(palette = "Set1")+
  scale_x_date(date_breaks = "1 year", name = "Ano", labels = date_format("%Y"))+
  theme_bw()

p9 <- p9 + labs(linetype = "Taxa")
p9 <- p9 + labs(colour = "Taxa")
p9 <- p9 + theme(legend.position = "top", legend.key.size = unit(.5, "cm"), axis.text.x = element_text(angle = 25, hjust = 1, size = 7), axis.title.y = element_text(size = 7), axis.title.x = element_text(size = 7))

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Swap_Selic.pdf", width = 6, height = 3)
p9
#dev.off()
```

### 3. PIB mensal

```{r, message = FALSE, warning = FALSE}
#######################
# PIB Mensal          #
#######################
cores <- brewer.pal(6, "Dark2")

meses <- ggmonthplot(PIBmensal) + 
  theme_bw() +
  scale_y_continuous(name = "PIB mensal (R$ - milhões)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Média diária e mensal da variação do PIB", x = "Mês", subtitle = "Nenhuma transformação")

# Gráfico por ano e mês
season <- ggseasonplot(PIBmensal, year.labels = TRUE) + 
  geom_point() + 
  theme_bw() + 
  scale_y_continuous(name = "PIB mensal (R$ - milhões)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Média mensal da da variação do PIB", x = "Mês", subtitle = "Nenhuma transformação")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Season_PIB.pdf", width = 6, height = 3)
season
#dev.off()

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Month_PIB.pdf", width = 6, height = 3)
meses
#dev.off()

bp_ts <- breakpoints(PIBmensal ~ 1)
ci_ts <- confint(bp_ts)

Data <- seq(as.Date("1996-01-01"), length = length(PIBmensal), by = "1 month")
df1 <- melt(data.frame(Data,PIBmensal), id.vars = "Data")
names(df1) <- c("Data", "Variavel", "Valor")

p1 <- ggplot(df1[which(df1$Variavel == "PIBmensal"),], aes(Data, Valor, colour = Variavel)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="PIB mensal (R$ milhões)") +
        scale_x_date(date_breaks = "12 months", name = "Data", labels = date_format("%m-%Y"))+ 
        geom_vline(xintercept = Data[bp_ts$breakpoints], linetype="longdash")+
        geom_segment(aes(x = Data[ci_ts$confint[1]], y = min(PIBmensal), xend = Data[ci_ts$confint[5]], yend = min(PIBmensal)))+
        geom_segment(aes(x = Data[ci_ts$confint[2]], y = min(PIBmensal), xend = Data[ci_ts$confint[6]], yend = min(PIBmensal)))+
        geom_segment(aes(x = Data[ci_ts$confint[3]], y = min(PIBmensal), xend = Data[ci_ts$confint[7]], yend = min(PIBmensal)))+
        geom_segment(aes(x = Data[ci_ts$confint[4]], y = min(PIBmensal), xend = Data[ci_ts$confint[8]], yend = min(PIBmensal)))+
        theme_bw()
p1 <- p1 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), legend.position = "none")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Quebra_PIB.pdf", width = 6, height = 3)
p1
#dev.off()

m <- seas(x = PIBmensal, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)

# Even though the series presents structural breaks, I'm not dividing to make the adjustment because for the individual pieces the seasonal adjustment is not effective

# Salva a série final em uma nova variável
PIB2 <- final(m)

# Compara a série ajustada com a série original
df <- data.frame(seq(as.Date("1996-01-01"), length = length(PIBmensal), by = "1 month"), PIBmensal, PIB2)
names(df) <- c("Data", "Original", "Série Filtrada")
p2 <- ggplot(df, aes(Data)) +
  geom_line(aes(y = PIBmensal, colour = "Original"), linetype = "dashed") +
  geom_line(aes(y = PIB2, colour = "Filtrada")) + 
  scale_x_date(date_breaks = "12 months", name = "Ano", labels = date_format("%Y"))+
  scale_y_continuous(name = "PIB Mensal (R$ milhões)")+
  labs(color="Série") +
  scale_colour_manual("Variável", breaks = c("Original", "Filtrada"), values = c(cores[1], cores[2]))+
  theme_bw() + theme(axis.text.x = element_text(angle=30, hjust = 1, size = 7), legend.position = "top")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-AntesDepois_PIB.pdf", width = 6, height = 3)
p2
#dev.off()

# Now we transform to GDP growth rate
PIBm.df <- ur.df(PIB2, type = "trend", selectlags = "AIC", lags = 20)
summary(PIBm.df)

# Since it is non-stationary, we take log difference
PIB <- diff(log(PIB2), 1)
autoplot(PIB)
PIB.df <- ur.df(PIB, type = "none", selectlags = "AIC", lags = 20)
summary(PIB.df)

# Let's try to plot everything together
df <- data.frame(seq(as.Date("1996-01-01"), length = length(PIBmensal[-length(PIBmensal)]), by = "1 month"), PIBmensal[-length(PIBmensal)]/10^(6), PIB2[-length(PIB2)]/10^(6), PIB)
names(df) <- c("Data", "Original", "Série Filtrada", "Série diferenciada")
p3 <- ggplot(df, aes(Data)) +
  geom_line(aes(y = PIBmensal[-length(PIBmensal)]/10^(6), colour = "Original")) +
  geom_line(aes(y = PIB2[-length(PIB2)]/10^(6), colour = "Filtrada")) + 
  geom_line(aes(y = PIB, colour = "Diferenciada")) + 
  scale_x_date(date_breaks = "12 months", name = "Data", labels = date_format("%Y"))+
  scale_y_continuous(name = "PIB Mensal (base = 03/18)")+
  labs(color="Variável") +
  theme_bw()
p3 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 8))

```

### 4. Exchange rate

```{r, message = FALSE, warning = FALSE}
#######################
# Câmbio              #
#######################
cores <- brewer.pal(6, "Dark2")

meses <- ggmonthplot(cambio_raw) + 
  theme_bw() +
  scale_y_continuous(name = "Taxa de Câmbio Efetiva Real (índice)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Média diária e mensal da taxa de câmbio", x = "Month", subtitle = "No data transformation")

# Gráfico por ano e mês
season <- ggseasonplot(cambio_raw, year.labels = TRUE) + 
  geom_point() + 
  theme_bw() + 
  scale_y_continuous(name = "Taxa de Câmbio Efetiva Real (índice)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Monthly average of exchange rate", x = "Month", subtitle = "No data transformation")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Season_CAMBIO.pdf", width = 6, height = 3)
season
#dev.off()

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Month_CAMBIO.pdf", width = 6, height = 3)
meses 
#dev.off() 

bp_ts <- breakpoints(cambio_raw ~ 1)
ci_ts <- confint(bp_ts)

Data <- seq(as.Date("1996-01-01"), length = length(cambio_raw), by = "1 month")
df1 <- melt(data.frame(Data,cambio_raw), id.vars = "Data")
names(df1) <- c("Data", "Variavel", "Valor")

p1 <- ggplot(df1[which(df1$Variavel == "cambio_raw"),], aes(Data, Valor, colour = Variavel)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="Taxa de Câmbio Efetiva Real (índice)") +
        scale_x_date(date_breaks = "12 months", name = "Date", labels = date_format("%m-%Y"))+ 
        geom_vline(xintercept = Data[bp_ts$breakpoints], linetype="longdash")+
        geom_segment(aes(x = Data[ci_ts$confint[1]], y = min(cambio_raw), xend = Data[ci_ts$confint[5]], yend = min(cambio_raw)))+
        geom_segment(aes(x = Data[ci_ts$confint[2]], y = min(cambio_raw), xend = Data[ci_ts$confint[7]], yend = min(cambio_raw)))+
        geom_segment(aes(x = Data[ci_ts$confint[3]], y = min(cambio_raw), xend = Data[ci_ts$confint[8]], yend = min(cambio_raw)))+
        geom_segment(aes(x = Data[ci_ts$confint[4]], y = min(cambio_raw), xend = Data[ci_ts$confint[9]], yend = min(cambio_raw)))+
        geom_segment(aes(x = Data[ci_ts$confint[5]], y = min(cambio_raw), xend = Data[ci_ts$confint[10]], yend = min(cambio_raw)))+
        theme_bw()
p1 <- p1 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), legend.position = "none")
p1

m <- seas(x = cambio_raw, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)

cambio <- cambio_raw
# Não tem evidência que precisa ajuste sazonal na série toda
# Como não fiz nenhuma transformação não tem muito o que plotar de gráfico aqui

```

### 5. IPCA

```{r, message = FALSE, warning = FALSE}
#######################
# IPCA                #
#######################
cores <- brewer.pal(6, "Dark2")

meses <- ggmonthplot(ipca) + 
  theme_bw() +
  scale_y_continuous(name = "Taxa de Inflação (IPCA - % a.a.)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Monthly average of the inflation index", x = "Month", subtitle = "No data transformation")

# Gráfico por ano e mês
season <- ggseasonplot(ipca, year.labels = TRUE) + 
  geom_point() + 
  theme_bw() + 
  scale_y_continuous(name = "Taxa de Inflação (IPCA - % a.a.)") +
  labs(title = "", x = "Mês", subtitle = "")+
  theme(axis.title = element_text(size=7), axis.text.x = element_text(angle=25, hjust = 1, size = 7))
  #labs(title = "Monthly average of the inflation index", x = "Month", subtitle = "No data transformation")

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Season_IPCA.pdf", width = 6, height = 3)
season
#dev.off()

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Month_IPCA.pdf", width = 6, height = 3)
meses
#dev.off()


bp_ts <- breakpoints(ipca ~ 1)
ci_ts <- confint(bp_ts)

Data <- seq(as.Date("1996-01-01"), length = length(ipca), by = "1 month")
df1 <- melt(data.frame(Data,ipca), id.vars = "Data")
names(df1) <- c("Data", "Variavel", "Valor")

p1 <- ggplot(df1[which(df1$Variavel == "ipca"),], aes(Data, Valor, colour = Variavel)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="Inflation (% monthly)") +
        scale_x_date(date_breaks = "12 months", name = "Date", labels = date_format("%m-%Y"))+ 
        geom_vline(xintercept = Data[bp_ts$breakpoints], linetype="longdash")+
        geom_segment(aes(x = Data[ci_ts$confint[1]], y = min(ipca), xend = Data[ci_ts$confint[5]], yend = min(ipca)))+
        geom_segment(aes(x = Data[ci_ts$confint[2]], y = min(ipca), xend = Data[ci_ts$confint[6]], yend = min(ipca)))+
        theme_bw()
p1 <- p1 + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), legend.position = "none")
p1

# Now I divide the series in 3 different pieces to apply the seasonal filter
# Salvando três séries para passar o seasonal
ipca_a <- ipca[1:(bp_ts$breakpoints[1]-1)]
ipca_b <- ipca[(bp_ts$breakpoints[1]):(bp_ts$breakpoints[2]-1)]
ipca_c <- ipca[(bp_ts$breakpoints[2]):(length(ipca))]
ipca_a <- ts(ipca_a,  start = c(1996, 01, 01), frequency = 12)
ipca_b <- ts(ipca_b,  start = c(2002, 03, 01), frequency = 12)
ipca_c <- ts(ipca_c,  start = c(2005, 06, 01), frequency = 12)

# There is no evidence of seasonal component in either the complete series nor the pieces
m <- seas(x = ipca_a, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)
# Não tem evidência que precisa ajuste sazonal na primeira parte
m <- seas(x = ipca_b, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)
# Não tem evidência que precisa ajuste sazonal na segunda parte
m <- seas(x = ipca_c, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)
# Não tem evidência que precisa ajuste sazonal na terceira parte

m <- seas(x = ipca, transform.function = "none", regression.aictest = NULL)
qs(m)
summary(m)
# Não tem evidência que precisa ajuste sazonal na série toda

# Como não fiz nenhuma transformação não tem muito o que plotar de gráfico aqui
```


## Variávels finais após ajuste sazonal

```{r, warning = FALSE, message = FALSE, echo = FALSE}
# Make dummy observations to complete the swap series - I need to plot the graph. Later I'll drop, treat seasonality and merge with selic
dummy <- ts(rep(0, length(seq(from = as.Date(inicio), to = as.Date(inicio_swap2), by = "1 month"))),  start = c(1996, 01, 01), frequency = 12)
## Binding the series
comb <- ts.union(dummy, swap90)
swap <- pmin(comb[,1], comb[,2], na.rm = TRUE)
swap[1:44] <- NA


# Repete o mesmo gráfico de antes, mas com as variáveis dessazonalizadas
cores <- brewer.pal(6, "Dark2")
df1 <- data.frame(seq(as.Date(inicio), length = length(ipca), by = "1 month"), capital_trabalho_final*100, swap, PIB*100, cambio, ipca)
names(df1) <- c("Data", "Capital_trabalho", "Swap", "PIB", "Cambio", "IPCA")
df2 <- melt(data = df1, id.vars = "Data")

# Gráficos individuais
p1a <- ggplot(df2[which(df2$variable == "Capital_trabalho"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[1])+
        scale_y_continuous(name="Capital trabalho \n") +
        scale_x_date(date_breaks = "24 months")+ 
        theme_bw()
p1a <- p1a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

p2a <- ggplot(df2[which(df2$variable == "Swap"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[5])+
        scale_y_continuous(name="Swap\n (%a.a.)") +
        scale_x_date(date_breaks = "24 months")+ 
        theme_bw()
p2a <- p2a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

p3a <- ggplot(df2[which(df2$variable == "PIB"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[3])+
        scale_y_continuous(name="PIB\n (var. % mensal)") +
        scale_x_date(date_breaks = "24 months")+
        theme_bw()
p3a <- p3a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

p4a <- ggplot(df2[which(df2$variable == "Cambio"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[4])+
        scale_y_continuous(name="Tx. Câmbio\n (índice)") +
        scale_x_date(date_breaks = "24 months", name = "Ano", labels = date_format("%Y"))+
        theme_bw()
p4a <- p4a + theme(axis.text.x = element_text(angle=25, hjust = 1, size = 6), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

p5a <- ggplot(df2[which(df2$variable == "IPCA"),], aes(Data, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, colour = cores[6])+
        scale_y_continuous(name="IPCA\n (acum. 12m.)") +
        scale_x_date(date_breaks = "24 months")+
        theme_bw()
p5a <- p5a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6))

grid.arrange(p1a, p2a, p3a, p4a, p5a, ncol=1, nrow = 5)

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-Series_semcom_ajuste.pdf", width = 6, height = 6)
grid.arrange(p1ori, p1a, p6ori, p5a, p3ori, p3a, p2ori, p2a, p4ori, p4a, ncol=2, nrow = 5)
#dev.off()
``` 

## Descritivas

```{r, results='axis', message=FALSE, warning=FALSE, echo = FALSE}
### Descriptives

descriptives     <- matrix(NA, nrow = 8, ncol = (ncol(df1)-1))
rownames(descriptives) <- c("Observações", "Mínimo", "1o quartil",
                      "Média", "Mediana",  "3o quartil", "Máximo",
                      "Desv. Pad.")

colnames(descriptives) <- names(df1)[-1]

desc <- function(x) {
  n       <- length(x)
  minimum <- min(x, na.rm = TRUE)
  first_q <- quantile(x, 0.25, na.rm = TRUE)
  media   <- mean(x, na.rm = TRUE)
  mediana <- median(x, na.rm = TRUE)
  third_q <- quantile(x, 0.75, na.rm = TRUE)
  maximum <- max(x, na.rm = TRUE)
  std     <- sd(x, na.rm = TRUE)

    return(list(n = n, minimum = minimum, first_quar = first_q, media = media, mediana = mediana, third_quar = third_q, maximum = maximum, std = std))
}

for (i in 1:8){
  descriptives[i, 1] <- round(as.numeric(desc(df1[,2])[i]),4)
  descriptives[i, 2] <- round(as.numeric(desc(df1[,3])[i]),4)
  descriptives[i, 3] <- round(as.numeric(desc(df1[,4])[i]),4)
  descriptives[i, 4] <- round(as.numeric(desc(df1[,5])[i]),4)
  descriptives[i, 5] <- round(as.numeric(desc(df1[,6])[i]),4)
}

descriptives[1,] <- as.integer(descriptives[1,])
descriptives <- data.frame(descriptives)

stargazer(descriptives, summary=FALSE, header = TRUE, type = 'html')
#stargazer(descriptives, summary=FALSE, header = TRUE, type = 'latex')

# ndiffs(x = capital_trabalho_final, test = "adf", alpha = .1)
# ndiffs(x = ipca, test = "adf", alpha = .1)
# ndiffs(x = cambio, test = "adf", alpha = .1)
# ndiffs(x = PIB2, test = "adf", alpha = .1)
# ndiffs(x = swap90, test = "adf", alpha = .1)

rm(descriptives, df1, bp_ts, ci_ts, comb, df, df2, m, p1a, p2, p2a, p3, p3a, p4, p4a, p5a, p6, ano, ano_ipca, capital_trabalho, dia, final, ipca_acum, cambio_raw, fim, fim_ipca, inicio, inicio_cambio, inicio_deflator, inicio_ipca2, selic, mes, mes_ipca)
``` 

# Estimating the BVAR

```{r}
# Junta o swap com a selic
selic_trim <- ts(selic_final[1:44], start = c(1996, 01, 01), frequency = 12)

# Binding the series
comb <- ts.union(selic_trim, swap90)
swap <- pmin(comb[,1], comb[,2], na.rm = TRUE)

#Inflação - Produto - Juros - Câmbio - Desigualdade.
var1 <- cbind(capital_trabalho_final*100, ipca, PIB*100, swap, cambio) # The bvar function does not allows data.frames
#var2 <- cbind(capital_trabalho_final, swap, PIB2, cambio, ipca) # The bvar function does not allows data.frames
names(var1) <- c("capital_trabalho", "ipca", "pib", "swap", "cambio")
#names(var1) <- c("ipca", "pib", "swap", "cambio","capital_trabalho") # Ficou uma merda

#var1 <- c(1,2,3,4,5)

pos_ct     <- grep("capital_trabalho", names(var1))
pos_swap   <- grep("swap", names(var1))
pos_pib    <- grep("pib", names(var1))
pos_cambio <- grep("cambio", names(var1))
pos_ipca   <- grep("ipca", names(var1))


set.seed(6969)

nburn.    <- 1000000 # Burn the first 100kk replications
nrep.     <- 100000 # Estimate another 100k times after burn in
thinfac.  <- 4 # But keep only 1 in 4 estimates
p.        <- 1 # Number of lags
tau.      <- 48 - p. # Number of observations to use as prior
nf.       <- 1 # Number of forecast periods
k_B.      <- 6 # Fator de inflação na priori
k_A.      <- 4 # Fator de inflação na priori

# No idea what's this for
tamanho <- floor(1/thinfac.*nrep.)
# número de tempos
tempo <- nrow(var1)

pm <- proc.time()
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., thinfac = thinfac., nf = nf., k_B = k_B., k_A = k_A.)
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit.rds") 
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit.rds") 
#rm(fit1, ira)
proc.time() - pm
```

Caso queira ver qual a priori, descomente esses blocos de código (que estão ocultos).

```{r, eval = FALSE, echo = FALSE}
# Essa função é para eu descobrir o que ele está usando de priori.

library(compiler)

tsprior2 <- cmpfun(function(priordat,nlag,ndraws=4000){
  
  M <- dim(priordat)[2]
  K <- M + nlag*(M^2) # nr of beta parameters
  numa <- 0.5*M*(M-1) # nr of VCV elements
  
  yt <- t(priordat[(nlag+1):(dim(priordat)[1]),]) # LHS variable
  tau <- dim(yt)[2] # New sample size
  Zt <- makeregs(priordat,0,nlag) # Regressor matrix
  
  vbar <- matrix(0,K,K)
  xhy <- matrix(0,K,1)
  
  for (i in 1:tau){
    zhat1 <- Zt[((i-1)*M+1):(i*M),]
    vbar <- vbar + t(zhat1) %*% zhat1
    xhy <- xhy + t(zhat1) %*% matrix(yt[,i],M,1)
  }
  aols <- solve(vbar) %*% xhy
  
  sse2 <- matrix(0,M,M)
  for (i in 1:tau){
    e <- matrix(yt[,i] - Zt[((i-1)*M+1):(i*M),] %*% aols,M,1)
    sse2 <- sse2 + e %*% t(e) 
  }
  hbar <- sse2/tau
  hbarinv <- solve(hbar)
  
  vbar <- matrix(0,K,K)
  for (i in 1:tau){
    zhat1 <- Zt[((i-1)*M+1):(i*M),]
    vbar <- vbar + t(zhat1) %*% hbarinv %*% zhat1
  }
  vbar <- solve(vbar)
  
  achol <- t(chol(hbar))
  ssig <- diag(achol)
  for (i in 1:M){
    for (j in 1:M){
      achol[j,i] <- achol[j,i]/ssig[i] 
    } 
  }
  achol <- solve(achol)
  
  a0 <- matrix(0,numa,1)
  ic <- 1
  for (i in 2:M){
    for (j in 1:(i-1)){
      a0[ic,1] <- achol[i,j]
      ic <- ic + 1 
    }
  }
  
  ssig1 <- log(ssig^2)
  
  hbar1 <- solve(tau*hbar)
  hdraw <- matrix(0,M,M)
  a02mo <- matrix(0,numa,numa)
  a0mean <- matrix(0,numa,1)
  
  for (irep in 1:ndraws){
    hdraw <- solve(rWishart(1,tau,hbar1)[,,1])
    achol <- t(chol(hdraw))
    ssig <- diag(achol)
    for (i in 1:M){
      for (j in 1:M){
        achol[j,i] <- achol[j,i]/ssig[i]
      } 
    }
    achol <- solve(achol)
    
    a0draw <- matrix(0,numa,1)
    ic <- 1
    for (i in 2:M){
      for (j in 1:(i-1)){
        a0draw[ic,1] <- achol[i,j]
        ic <- ic + 1 
      }
    }
    a02mo <- a02mo + a0draw %*% t(a0draw)
    a0mean <- a0mean + a0draw
  }
  
  a02mo <- a02mo / ndraws
  a0mean <- a0mean / ndraws
  a02mo <- a02mo - a0mean %*% t(a0mean)
  
  return(list(B_OLS=aols, VB_OLS = vbar, A_OLS = a0, sigma_OLS = ssig1, VA_OLS = a02mo))
}) 

makeregs <- cmpfun(function(dat,cut,p){
  
  t <- dim(dat)[1]
  M <- dim(dat)[2]
  K <- M + p*(M^2)
  
  Z <- matrix(NA,t*M,K)
  
  for (i in (cut+p+1):t){
    ztemp <- diag(M)
    for (j in 1:p){        
      xtemp <- t(diag(M) %x% dat[i-j,])
      ztemp <- cbind(ztemp,xtemp)
    }
    Z[((i-1)*M+1):(i*M),] <- ztemp
  }
  
  return(Z[((cut+p)*M+1):(t*M),])
})
```


```{r, eval = FALSE, echo = FALSE}
priori <- tsprior2(var1[1:(tau.+p.),],p.,2000)

B_0_prmean <- priori$B_OLS
B_0_prvar <- priori$VB_OLS
A_0_prmean <- priori$A_OLS
A_0_prvar <- priori$VA_OLS

sigma_prmean <- priori$sigma_OLS

#write.csv(sigma_prmean, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\sigma_prmean.csv")
```


# Funções impulso resposta

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Colocando as datas como strings
tm1 <- as.yearmon(time(var1))

# Eixo x
xax <- time(var1)
# Perde p. obervações pelo lag e outras .tau  pela amostra para estimar por MQO, então começa no tempo 1+p.+tau.
ini_xax <- 1+p.+tau.
xax <- xax[ini_xax:tempo]

# Marcas verticais
d <- ymd(Data[1])
gp_ini <- d %m+% months(ini_xax)
gp <- seq(year(gp_ini), year(tail(Data,1)), 1)
```


Peguei a explicação daqui [daqui](https://github.com/FK83/bvarsv/blob/master/bvarsv_Nov2015_website.pdf):
A FIR estima o impacto de um choque unitário em algum elemento de $\varepsilon_t$. Os elementos de $c_t$, $B_{j,t}$ e $A_t$ em (1) são mantidos fixos em seus valores em $t$, mas os elementos de $\Sigma_t$ são substituídos pela média de todos os períodos. Note que a ordem das variáveis importa e deve ser justificada por argumentos econômicos. As FIR contém os percentis 5, 25, 50, 75 e 95.

```{r, echo = FALSE, message = FALSE}
# Funções auxiliares
mytheme_cima <- theme_bw() + 
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),                    
        axis.ticks.x=element_blank(),
        axis.title.y = element_blank(),
        axis.text.y=element_text(size = 5.5),
        plot.title = element_text(size=6, vjust = -0.5),
        plot.margin = unit(c(0,1,1,0), "mm"))

mytheme_baixo <- theme_bw() + 
  theme(axis.text.x=element_text(angle=25, hjust = 1, size = 6, vjust = 0.3),
        axis.title.y = element_blank(),
        axis.title.x=element_blank(),
        plot.title = element_text(size=6, vjust = -0.5),
        axis.text.y=element_text(size = 5.5),
        plot.margin = unit(c(0,1,1,0), "mm"))
 
number_ticks <- function(n) {function(limits) pretty(limits, n)}
 
nhor <- 48
```

## Impactos dos choques monetários

### Em todas variáveis do modelo, no último período

```{r, echo = FALSE, message = FALSE}
 
# Último período (fev 2018)
 
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_swap_ct <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="burlywood2", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="burlywood2", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            theme_bw() + 
            theme(axis.title.x=element_blank(),
            axis.text.x=element_text(hjust = 1, size = 6, vjust = 0),                    
            axis.ticks.x=element_blank(),
            axis.title.y = element_blank(),
            axis.text.y=element_text(size = 5.5),
            plot.title = element_text(size=6, vjust = -0.5),
            plot.margin = unit(c(0,1,1,0), "mm"))

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_swap_ipca <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="burlywood2", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="burlywood2", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("IPCA (acum. 12 meses)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            theme_bw() + 
            theme(axis.title.x=element_blank(),
            axis.text.x=element_text(size = 6, vjust = 0),                    
            axis.ticks.x=element_blank(),
            axis.title.y = element_blank(),
            axis.text.y=element_text(size = 5.5),
            plot.title = element_text(size=6, vjust = -0.5),
            plot.margin = unit(c(0,1,1,0), "mm"))

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_swap_pib <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="burlywood2", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="burlywood2", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Tx. variação do PIB") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            theme_bw() + 
            theme(axis.title.x=element_blank(),
            axis.text.x=element_text(size = 6, vjust = 0),                    
            axis.ticks.x=element_blank(),
            axis.title.y = element_blank(),
            axis.text.y=element_text(size = 5.5),
            plot.title = element_text(size=6, vjust = -0.5),
            plot.margin = unit(c(0,1,1,0), "mm"))

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_swap_cambio <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'burlywood4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'burlywood2', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="burlywood2", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="burlywood4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="burlywood2", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Índice da Taxa de Câmbio") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            theme_bw() + 
            theme(axis.title.x=element_blank(),
            axis.text.x=element_text(size = 6, vjust = 0),                    
            axis.ticks.x=element_blank(),
            axis.title.y = element_blank(),
            axis.text.y=element_text(size = 5.5),
            plot.title = element_text(size=6, vjust = -0.5),
            plot.margin = unit(c(0,1,1,0), "mm"))

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-Swap.pdf", width = 6, height = 6)
grid.arrange(ira_swap_ct, ira_swap_ipca, ira_swap_pib, ira_swap_cambio, ncol=2, nrow = 2)
#dev.off()

```

### Na razão capital trabalho
```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do swap na razão capital-trabalho 
################################################################
 
# Último período (fev 2018)
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, draw.plot = FALSE)
#dev.off()

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

# Primeiro período (jan 2000) 01
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Apagão elétrico (jun 2001) 02
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# expansão econômica 2002 (escolhi junho) 03
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Eleição do Lula (out 2002) 04
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=34)


# Posse do Lula (jan 2003) 05
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mensalão (junho 2005) 06
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Crise 2008 (jun 2008) 07
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# expansão econômica junho 2010 08
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Início da crise (mar 14) 09
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Início de 2015 (jan 15)
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 181)

# Início de 2016 (março 16) 10
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo
 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-Swap-CT.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()
```

Na razão capital trabalho porém em períodos de mudança no Banco Central.

Os presidentes do BCB no período analisado foram:

* Arminio Fraga Neto - 4/3/1999 a 1/1/2003 
* Henrique de Campos Meirelles - 1/1/2003 a 1/1/2011 $t=37$
* Alexandre Antonio Tombini - 1/1/2011 a 8/6/2016 $t=133$
* Ilan Goldfajn  - 9/6/2016 - atual $t=198$

Supondo que existe algum tipo de coordenação entre política fiscal e monetária, peguei os Ministros da Fazenda no Período também:

* Pedro Malan - 01/01/1995 a 01/01/2003 
* Antonio Palocci Filho - 01/01/2003 a 27/03/2006 $t=37$
* Guido Mantega - 27/03/2006 a 01/01/2015 $t=75$
* Joaquim Levy - 01/01/2015 a 18/12/2015 $t=183$
* Nelson Barbosa - 18/12/2015 a 12/05/2016 $t=192$
* Henrique Meirelles - 12/05/2016 a 10/04/2018 $t=197$
* Eduardo Guardia - 10/04/2018 - atual 

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do swap na razão capital-trabalho 
################################################################
 
# Henrique de Campos Meirelles - 1/1/2003 a 1/1/2011 $t=37$ e Antonio Palocci Filho - 01/01/2003 a 27/03/2006 $t=37$

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Janeiro/2003 - Palocci e Meirelles (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Guido Mantega - 27/03/2006 a 01/01/2015 $t=75$ (ministro da fazenda)

# Apagão elétrico (jun 2001) 02
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=75, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2006 - Mantega e Meirelles (t=75)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Alexandre Antonio Tombini - 1/1/2011 a 8/6/2016 $t=133$
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 133, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Nov/2011 - Mantega e Tombini (t=133)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Joaquim Levy - 01/01/2015 a 18/12/2015 $t=183$
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t=183, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jan/2015 - Levy e Tombini (t=183)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Nelson Barbosa - 18/12/2015 a 12/05/2016 $t=192$

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 192, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jan/2015 - Nelson Barbosa e Tombini (t=192)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

# * Ilan Goldfajn  - 9/6/2016 - atual $t=198$ e Henrique Meirelles - 12/05/2016 a 10/04/2018 $t=197$
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ct, scenario = 3, nhor = 48, t = 197, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jun/2016 Meirelles e Goldfajn (t=197)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo
 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\FIR\\Fig-FIR-Swap-CT-bcb.pdf", width = 6, height = 4)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_09, ira_final, ncol=2, nrow = 3)
#dev.off()
```

### No PIB

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do swap no PIB
################################################################
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\FIR\\Fig_FIR-swap_pib2.pdf", width = 6, height = 3)

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Var. % PIB") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000, 01, t=1
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) + 
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Var. % PIB") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001, 02, t=18
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Var. % PIB") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) + 
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# junho 2002, 03, t=30
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2))) 
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") + 
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Outubro 2002 - 04 - t=34
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=34)


# Jan 2003 05 - t = 37
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Junho 2005 - 05 - t=66
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# junho 2008- t=102
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

#  junho 2010, t = 126
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# março 2014 - t = 174
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 16 - t=195
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_pib, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-Swap-PIB.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_swap_pib.csv")
```

### No Câmbio

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do swap no câmbio 
################################################################

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48,t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48,t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_cambio, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-Swap-CAMBIO.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_swap_cambio.csv")
```

### No IPCA

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta swap no IPCA 
################################################################

ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

#Jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_swap, response.variable = pos_ipca, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-Swap-IPCA.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_swap_ipca.csv")

```

## Choques do PIB

### Na razão capital trabalho

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do PIB na razão capital trabalho
################################################################

ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000 -- 01
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# jun 2001 -- 02 
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002 - 03
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002 - 04
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=34)

# Jan 2003 - 05
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005 - 06
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008 - 07
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010 - 08
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima


# Mar 14 - 09
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=181)

# Mar 16 - 10
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ct, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-PIB-CT.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_pib_ct.csv")
```

### No Câmbio

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do PIB no câmbio
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

#jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Jan/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=34)


# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_cambio, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-PIB-CAMBIO.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

```

### No swap

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do PIB na swap 
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swapo") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_swap, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo
 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-PIB-SWAP.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()
```

### No IPCA

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do PIB no IPCA
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_pib, response.variable = pos_ipca, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo
 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-PIB-IPCA.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()
```

## Choques na taxa de câmbio

### Efeito do câmbio na razão capital-trabalho

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do Cambio na razão capital trabalho 
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

# Jan 2000 - 01
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001 - 02
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002 -03
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002 - 04
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=34)

# Jan 2003 - 05
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005 - 06
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital Trabalho") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008 -07
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010 - 08
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14 - 09
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=181)

# Mar 16 - 10
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ct, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-CAMBIO-CT.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_cambio_ct.csv")
```

### Efeito do câmbio No Swap

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do Cambio no SWAP
################################################################ 
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

# Jan 2000 - 01
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001 - 02
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002 -03
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002 - 04
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=34)

# Jan 2003 - 05
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005 - 06
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008 -07
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010 - 08
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14 - 09
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=181)

# Mar 16 - 10
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_swap, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-CAMBIO-SWAP.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_cambio_ct.csv")
```

### Efeito do câmbio No IPCA

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do Cambio no IPCA
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, draw.plot = FALSE) 

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

# Jan 2000 - 01
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001 - 02
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002 -03
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002 - 04
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=34)

# Jan 2003 - 05
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005 - 06
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008 -07
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010 - 08
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14 - 09
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=181)

# Mar 16 - 10
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_ipca, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("IPCA") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-CAMBIO-IPCA.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_cambio_ct.csv")
```

### Efeito do câmbio No PIB

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do Cambio no PIB
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, draw.plot = FALSE) 

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

# Jan 2000 - 01
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2001 - 02
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002 -03
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002 - 04
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=34)

# Jan 2003 - 05
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005 - 06
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008 -07
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010 - 08
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14 - 09
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=181)

# Mar 16 - 10
ira <- impulse.responses(fit1, impulse.variable = pos_cambio, response.variable = pos_pib, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-CAMBIO-PIB.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_cambio_ct.csv")
```

## Choques no IPCA

### Efeito do Ipca na razão capital-trabalho

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do IPCA na razão capital trabalho
################################################################

ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, draw.plot = FALSE) 

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000 - 01
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

#jun 2001 - 02
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002 - 03
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002 - 04
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=34)

# Jan 2003 - 05
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005 - 06
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008 - 07
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010 - 08
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14 -09
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=181)

# Mar 16 - 10
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_ct, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Razão Capital-Trabalho") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-IPCA-CT.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()

#write.csv(ira$irf, "C:\\Users\\aisha\\Documents\\Var da Aisha\\fir_ipca_ct.csv")
```

### Efeito do Ipca no swap

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do IPCA na swap
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95") 

ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Swap") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo


 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-IPCA-SWAP.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()
```

### Efeito do IPCA na taxa de câmbio

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do IPCA na Cambio
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")
 
ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_cambio, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("Tx. Câmbio") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-IPCA-CAMBIO.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()
```

### Efeito do IPCA no PIB

```{r, echo = FALSE, message = FALSE}
################################################################
# Função Impulso resposta do IPCA na PIB
################################################################
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")
 
ira_final <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Fevereiro/2018 (t=217)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

#Jan 2000
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=1, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_01 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Janeiro/2000 (t=1)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# jun 2001
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=18, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_02 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2001 (t=18)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2002
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=30, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_03 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Jun/2002 (t=30)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Out 2002
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=34)

# Jan 2003
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=37, draw.plot = FALSE)


ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_04 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Jan/2003 (t=37)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2005
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=66, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_05 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2005 (t=66)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2008
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=102, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_06 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2008 (t=102)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jun 2010
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=126, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_07 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Junho/2010 (t=126)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Mar 14
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=174, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_08 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Março/2014 (t=174)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_cima

# Jan 15
#ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_swap, scenario = 3, nhor = 48, t=181)

# Mar 16
ira <- impulse.responses(fit1, impulse.variable = pos_ipca, response.variable = pos_pib, scenario = 3, nhor = 48, t=195, draw.plot = FALSE)

ira2 <- data.frame(seq(1:nhor), t(apply(ira$irf, 2,stat.helper2)))
names(ira2) <- c("lag", "p5", "p25", "media", "p75", "p95")

ira_09 <- ggplot(data = ira2, aes(lag,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=lag, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=lag, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Meses") + ylab("PIB") + ggtitle("Março/2016 (t=195)") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_continuous(breaks=number_ticks(10))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo

 
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Figuras\\FIR\\Fig-FIR-IPCA-PIB.pdf", width = 6, height = 6)
grid.arrange(ira_01,  ira_02,  ira_03,  ira_04,  ira_05, ira_06, ira_07, ira_08, ira_09, ira_final, ncol=2, nrow = 5)
#dev.off()
```

## Avaliando os parâmetros

```{r, message = FALSE, warning = FALSE, echo = FALSE}
#rm(ira)

# Saving parameters
beta_ct     <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_ct)
beta_swap   <- parameter.draws(fit1, type = "lag1", row = pos_swap, col = pos_swap)
beta_pib    <- parameter.draws(fit1, type = "lag1", row = pos_pib, col = pos_pib)
beta_cambio <- parameter.draws(fit1, type = "lag1", row = pos_cambio, col = pos_cambio)
beta_ipca   <- parameter.draws(fit1, type = "lag1", row = pos_ipca, col = pos_ipca)

sd_ct       <- parameter.draws(fit1, type = "vcv", row = pos_ct, col = pos_ct)
sd_swap     <- parameter.draws(fit1, type = "vcv", row = pos_swap, col = pos_swap)
sd_pib      <- parameter.draws(fit1, type = "vcv", row = pos_pib, col = pos_pib)
sd_cambio   <- parameter.draws(fit1, type = "vcv", row = pos_cambio, col = pos_cambio)
sd_ipca     <- parameter.draws(fit1, type = "vcv", row = pos_ipca, col = pos_ipca)

beta_swap_ct    <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_swap)
beta_pib_ct     <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_pib)
beta_cambio_ct  <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_cambio)
beta_ipca_ct    <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_ipca)

# salva o fit em um csv e limpa da memória
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit.rds")
#fit1 <- readRDS("C:\\Users\\aisha\\Documents\\Var da Aisha\\Var7\\fit20.rds")
#rm(fit1)

# Convert stuff into mcmc objects
mcmc_beta_ct       <- mcmc(beta_ct, start = 1, end = dim(beta_ct)[1])
mcmc_beta_swap     <- mcmc(beta_swap, start = 1, end = dim(beta_swap)[1])
mcmc_beta_pib      <- mcmc(beta_pib, start = 1, end = dim(beta_pib)[1])
mcmc_beta_cambio   <- mcmc(beta_cambio, start = 1, end = dim(beta_cambio)[1])
mcmc_beta_ipca     <- mcmc(beta_ipca, start = 1, end = dim(beta_ipca)[1])

mcmc_sd_ct         <- mcmc(sd_ct, start = 1, end = dim(sd_ct)[1])
mcmc_sd_swap       <- mcmc(sd_swap, start = 1, end = dim(sd_swap)[1])
mcmc_sd_pib        <- mcmc(sd_pib, start = 1, end = dim(sd_pib)[1])
mcmc_sd_cambio     <- mcmc(sd_cambio, start = 1, end = dim(sd_cambio)[1])
mcmc_sd_ipca       <- mcmc(sd_ipca, start = 1, end = dim(sd_ipca)[1])

mcmc_beta_swap_ct   <- mcmc(beta_swap_ct, start = 1, end = dim(beta_swap_ct)[1])
mcmc_beta_pib_ct    <- mcmc(beta_pib_ct, start = 1, end = dim(beta_pib_ct)[1])
mcmc_beta_cambio_ct <- mcmc(beta_cambio_ct, start = 1, end = dim(beta_cambio_ct)[1])
mcmc_beta_ipca_ct   <- mcmc(beta_ipca_ct, start = 1, end = dim(beta_ipca_ct)[1])
```

Os gráficos abaixo contém os betas (esq) e volatilidade (dir) ao longo do tempo, com o 16o e o 68o percentis (como foi feito no artigo do Primiceri). 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
Data2 <- Data[(tau. + p.+1):length(Data)]

datemarks <- seq(1, length(Data2), by = 12)

mytheme_baixo2 <- theme_bw() + 
  theme(axis.text.x=element_text(angle=90, hjust = 10, size = 6, vjust = 0),
        axis.title.y = element_blank(),
        axis.title.x=element_blank(),
        plot.title = element_text(size=6, vjust = -0.5),
        axis.text.y=element_text(size = 5.5),
        plot.margin = unit(c(0,1,1,0), "mm"))
```

### Razão Capital-Trabalho

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Gráfico do coeficiente da variável defasada na razão capital-trabalho e desvio padrão do resíduo da equação
x1        <- t(apply(sqrt(sd_ct), 2, stat.helper))
x1betact  <- t(apply(beta_ct, 2, stat.helper))

x1betact2 <- t(apply(beta_ct, 2, stat.helper2))
x12       <- t(apply(sqrt(sd_ct), 2, stat.helper2))

# Novo Gráfico - coeficientes
df <- data.frame(Data2, x1betact, x1)
names(df) <- c("Data", "p16beta", "beta", "p84beta", "p16sd", "sd", "p84sd")

graph_beta_ct <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente da Razão Capital-Trabalho defasada em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_ct_alt <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente da Razão Capital-Trabalho defasada em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x1betact2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_ct2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente da Razão Capital-Trabalho defasada em sua própria equação") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

# Novo Gráfico - volatilidade
graph_sd_ct <- ggplot(data = df, aes(Data,sd)) +
                  #geom_line(aes(y = p16sd), colour = cols1[2], linetype = "dashed") +
                  #geom_line(aes(y = p84sd), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = sd), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=sd, ymin=p16sd), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84sd, ymin=sd), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x12)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_sd_ct2 <- ggplot(data = df2, aes(Data,media)) +
            #geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            #geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2
```

Coeficiente (da própria variável defasada) e desvio padrão do resíduo, usando a média e os quantis 16 e 84 (os mesmos do primiceri) - esquerda - e mesmo gráfico, porém com o intervalo entre o 5 e 95 (área azul) quantis e 25 e 75 quantis (área cinza):

```{r, echo = FALSE, warning = FALSE, message = FALSE}
grid.arrange(graph_beta_ct, graph_beta_ct2, graph_sd_ct, graph_sd_ct2, ncol = 2, nrow = 2)
```

### Swap

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Gráfico do desvio padrão do resíduo do swap
x2 <- t(apply(sqrt(sd_swap), 2, stat.helper))
x2betaswap <- t(apply(beta_swap, 2, stat.helper))

x22 <- t(apply(sqrt(sd_swap), 2, stat.helper2))
x2betaswap2 <- t(apply(beta_swap, 2, stat.helper2))

# Novo Gráfico - coeficientes
df <- data.frame(Data2, x2betaswap, x2)
names(df) <- c("Data", "p16beta", "beta", "p84beta", "p16sd", "sd", "p84sd")

graph_beta_swap <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_swap_alt <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x2betaswap2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_swap2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap defasado em sua própria equação") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

# Novo Gráfico - volatilidade
graph_sd_swap <- ggplot(data = df, aes(Data,sd)) +
                  #geom_line(aes(y = p16sd), colour = cols1[2], linetype = "dashed") +
                  #geom_line(aes(y = p84sd), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = sd), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=sd, ymin=p16sd), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84sd, ymin=sd), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do Swap (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x22)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_sd_swap2 <- ggplot(data = df2, aes(Data,media)) +
            #geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            #geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do Swap") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2
```

Coeficiente (da própria variável defasada) e desvio padrão do resíduo, usando a média e os quantis 16 e 84 (os mesmos do primiceri) - primeira coluna - e mesmo gráfico, porém com o intervalo entre o 5 e 95 (área azul) quantis e 25 e 75 quantis (área cinza) - segunda coluna. Também coloquei um gráfico do coeficiente com a escala vertical incluindo o zero - terceira coluna - para dar comparabilidade:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
grid.arrange(graph_beta_swap, graph_beta_swap2, graph_beta_swap_alt, graph_sd_swap, graph_sd_swap2,  ncol = 3, nrow = 2)
```

### PIB

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Gráfico do desvio padrão do resíduo do pib
x3 <- t(apply(sqrt(sd_pib), 2, stat.helper))
x3betapib <- t(apply(beta_pib, 2, stat.helper))

x32 <- t(apply(sqrt(sd_pib), 2, stat.helper2))
x3betapib2 <- t(apply(beta_pib, 2, stat.helper2))

# Novo Gráfico - coeficientes
df <- data.frame(Data2, x3betapib, x3)
names(df) <- c("Data", "p16beta", "beta", "p84beta", "p16sd", "sd", "p84sd")

graph_beta_pib <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_pib_alt <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x3betapib2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_pib2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB defasado em sua própria equação") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

# Novo Gráfico - volatilidade
graph_sd_pib <- ggplot(data = df, aes(Data,sd)) +
                  #geom_line(aes(y = p16sd), colour = cols1[2], linetype = "dashed") +
                  #geom_line(aes(y = p84sd), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = sd), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=sd, ymin=p16sd), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84sd, ymin=sd), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do PIB (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x32)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_sd_pib2 <- ggplot(data = df2, aes(Data,media)) +
            #geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            #geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do PIB") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2
```

Coeficiente (da própria variável defasada) e desvio padrão do resíduo, usando a média e os quantis 16 e 84 (os mesmos do primiceri) - primeira coluna - e mesmo gráfico, porém com o intervalo entre o 5 e 95 (área azul) quantis e 25 e 75 quantis (área cinza) - segunda coluna. Também coloquei um gráfico do coeficiente com a escala vertical incluindo o zero - terceira coluna - para dar comparabilidade:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
grid.arrange(graph_beta_pib, graph_beta_pib2, graph_beta_pib_alt, graph_sd_pib, graph_sd_pib2,  ncol = 3, nrow = 2)
```

### Taxa de Câmbio

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Gráfico do desvio padrão do resíduo do cambio
x4 <- t(apply(sqrt(sd_cambio), 2, stat.helper))
x4betacambio <- t(apply(beta_cambio, 2, stat.helper))

x42 <- t(apply(sqrt(sd_cambio), 2, stat.helper2))
x4betacambio2 <- t(apply(beta_cambio, 2, stat.helper2))

# Novo Gráfico - coeficientes
df <- data.frame(Data2, x4betacambio, x4)
names(df) <- c("Data", "p16beta", "beta", "p84beta", "p16sd", "sd", "p84sd")

graph_beta_cambio <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Índice da Tx. de Câmbio defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_cambio_alt <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Índice da Tx. de Câmbio defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x4betacambio2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_cambio2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Índice da Tx. de Câmbio defasado em sua própria equação") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

# Novo Gráfico - volatilidade
graph_sd_cambio <- ggplot(data = df, aes(Data,sd)) +
                  #geom_line(aes(y = p16sd), colour = cols1[2], linetype = "dashed") +
                  #geom_line(aes(y = p84sd), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = sd), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=sd, ymin=p16sd), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84sd, ymin=sd), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do Índice da Tx. de Câmbio (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x42)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_sd_cambio2 <- ggplot(data = df2, aes(Data,media)) +
            #geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            #geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do Índice da Tx. de Câmbio") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2
```

Coeficiente (da própria variável defasada) e desvio padrão do resíduo, usando a média e os quantis 16 e 84 (os mesmos do primiceri) - primeira coluna - e mesmo gráfico, porém com o intervalo entre o 5 e 95 (área azul) quantis e 25 e 75 quantis (área cinza) - segunda coluna. Também coloquei um gráfico do coeficiente com a escala vertical incluindo o zero - terceira coluna - para dar comparabilidade:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
grid.arrange(graph_beta_cambio, graph_beta_cambio2, graph_beta_cambio_alt, graph_sd_cambio, graph_sd_cambio2,  ncol = 3, nrow = 2)
```

### IPCA

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Gráfico do desvio padrão do resíduo do ipca
x5 <- t(apply(sqrt(sd_ipca), 2, stat.helper))
x5betaipca <- t(apply(beta_ipca, 2, stat.helper))

x52 <- t(apply(sqrt(sd_ipca), 2, stat.helper2))
x5betaipca2 <- t(apply(beta_ipca, 2, stat.helper2))

# Novo Gráfico - coeficientes
df <- data.frame(Data2, x5betaipca, x5)
names(df) <- c("Data", "p16beta", "beta", "p84beta", "p16sd", "sd", "p84sd")

graph_beta_ipca <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_ipca_alt <- ggplot(data = df, aes(Data,beta)) +
                  geom_line(aes(y = p16beta), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84beta), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = beta), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=beta, ymin=p16beta), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84beta, ymin=beta), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA defasado em sua própria equação (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x5betaipca2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_ipca2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA defasado em sua própria equação") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

# Novo Gráfico - volatilidade
graph_sd_ipca <- ggplot(data = df, aes(Data,sd)) +
                  #geom_line(aes(y = p16sd), colour = cols1[2], linetype = "dashed") +
                  #geom_line(aes(y = p84sd), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = sd), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=sd, ymin=p16sd), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84sd, ymin=sd), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do IPCA (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

df2 <- data.frame(Data2, x52)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_sd_ipca2 <- ggplot(data = df2, aes(Data,media)) +
            #geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            #geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            #geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Desvio Padrão") + ggtitle("Volatilidade na equação do IPCA") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2
```

Coeficiente (da própria variável defasada) e desvio padrão do resíduo, usando a média e os quantis 16 e 84 (os mesmos do primiceri) - primeira coluna - e mesmo gráfico, porém com o intervalo entre o 5 e 95 (área azul) quantis e 25 e 75 quantis (área cinza) - segunda coluna. Também coloquei um gráfico do coeficiente com a escala vertical incluindo o zero - terceira coluna - para dar comparabilidade:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
grid.arrange(graph_beta_ipca, graph_beta_ipca2, graph_beta_ipca_alt, graph_sd_ipca, graph_sd_ipca2,  ncol = 3, nrow = 2)
```

### Plotando as variáveis todas juntas

Primeiro, plotando os gráficos com o intervalo do 16o ao 84o quantil (como feito no Primiceri e como eu fiz no trabalho de Macro2:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
blank <- grid.rect(gp=gpar(col="white"))

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef1.pdf", width = 6, height = 8)
grid.arrange(graph_beta_ct, graph_beta_swap, graph_sd_ct, graph_sd_swap, 
             graph_beta_pib, graph_beta_cambio, graph_sd_pib, graph_sd_cambio,
             graph_beta_ipca, blank,  graph_sd_ipca, blank,
             ncol = 2, nrow = 6)
#dev.off()
```

Mas o que acontece se incluímos o zero no eixo vertical dos coeficientes?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef2.pdf", width = 6, height = 8)
grid.arrange(graph_beta_ct_alt, graph_beta_swap_alt, graph_sd_ct, graph_sd_swap, 
             graph_beta_pib_alt, graph_beta_cambio_alt, graph_sd_pib, graph_sd_cambio,
             graph_beta_ipca_alt, blank,  graph_sd_ipca, blank,
             ncol = 2, nrow = 6)
#dev.off()
```

Agora vamos repetir gráfico mas fazendo as bandas do quantil 5 a 95 (em azul) e 25 a 75 (em cinza) - sem forçar o zero no eixo dos coeficientes:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef3.pdf", width = 6, height = 8)
grid.arrange(graph_beta_ct2, graph_beta_swap2, graph_sd_ct2, graph_sd_swap2, 
             graph_beta_pib2, graph_beta_cambio2, graph_sd_pib2, graph_sd_cambio2,
             graph_beta_ipca2, blank,  graph_sd_ipca2, blank,
             ncol = 2, nrow = 6)
#dev.off()
```


### Gráfico dos coeficientes das outras variáveis defasadas na equação da razão capital-trabalho

```{r}
# Gráfico dos coeficientes das outras variáveis defasadas na equação da razão capital trabalho
x6beta_swap_ct    <- t(apply(beta_swap_ct, 2, stat.helper))
x6beta_pib_ct     <- t(apply(beta_pib_ct, 2, stat.helper))
x6beta_cambio_ct  <- t(apply(beta_cambio_ct, 2, stat.helper))
x6beta_ipca_ct    <- t(apply(beta_ipca_ct, 2, stat.helper))

# Novo Gráfico - coeficientes
df <- data.frame(Data2, x6beta_swap_ct, x6beta_pib_ct, x6beta_cambio_ct, x6beta_ipca_ct)
names(df) <- c("Data", "p16swap", "swap", "p84swap", 
               "p16pib", "pib", "p84pib", 
               "p16cambio", "cambio", "p84cambio",
               "p16ipca", "ipca", "p84ipca")

graph_beta_swap_ct <- ggplot(data = df, aes(Data,swap)) +
                  geom_line(aes(y = p16swap), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84swap), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = swap), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=swap, ymin=p16swap), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84swap, ymin=swap), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_swap_ct_alt <- ggplot(data = df, aes(Data,swap)) +
                  geom_line(aes(y = p16swap), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84swap), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = swap), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=swap, ymin=p16swap), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84swap, ymin=swap), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2
##
graph_beta_pib_ct <- ggplot(data = df, aes(Data,pib)) +
                  geom_line(aes(y = p16pib), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84pib), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = pib), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=pib, ymin=p16pib), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84pib, ymin=pib), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_pib_ct_alt <- ggplot(data = df, aes(Data,pib)) +
                  geom_line(aes(y = p16pib), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84pib), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = pib), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=pib, ymin=p16pib), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84pib, ymin=pib), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2
##
graph_beta_cambio_ct <- ggplot(data = df, aes(Data,cambio)) +
                  geom_line(aes(y = p16cambio), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84cambio), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = cambio), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=cambio, ymin=p16cambio), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84cambio, ymin=cambio), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Câmbio defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_cambio_ct_alt <- ggplot(data = df, aes(Data,swap)) +
                  geom_line(aes(y = p16cambio), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84cambio), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = cambio), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=cambio, ymin=p16cambio), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84cambio, ymin=cambio), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Câmbio defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2
##
graph_beta_ipca_ct <- ggplot(data = df, aes(Data,ipca)) +
                  geom_line(aes(y = p16ipca), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84ipca), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = ipca), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=ipca, ymin=p16ipca), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84ipca, ymin=ipca), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  #geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2

graph_beta_ipca_ct_alt <- ggplot(data = df, aes(Data,ipca)) +
                  geom_line(aes(y = p16ipca), colour = cols1[2], linetype = "dashed") +
                  geom_line(aes(y = p84ipca), colour = cols1[2], linetype = "dashed")+
                  geom_line(aes(y = ipca), colour = 'skyblue4', size = 0.25)+
                  geom_ribbon(aes(x=Data, ymax=ipca, ymin=p16ipca), fill= cols1[1], alpha=.3) +
                  geom_ribbon(aes(x=Data, ymax=p84ipca, ymin=ipca), fill= cols1[1], alpha=.3) +
                  xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA defasado na equação da Razão Capital-Trabalho (IC de 16 a 64)") +
                  scale_y_continuous(breaks = number_ticks(10)) +
                  scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
                  geom_hline(yintercept = 0, size=0.5)+
                  mytheme_baixo2


# Agora fazendo com os intervalos mais amplos
x6beta_swap_ct2    <- t(apply(beta_swap_ct, 2, stat.helper2))
x6beta_pib_ct2     <- t(apply(beta_pib_ct, 2, stat.helper2))
x6beta_cambio_ct2  <- t(apply(beta_cambio_ct, 2, stat.helper2))
x6beta_ipca_ct2    <- t(apply(beta_ipca_ct, 2, stat.helper2))


df2 <- data.frame(Data2, x6beta_swap_ct2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_swap_ct2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

graph_beta_swap_ct2_alt <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Swap na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

df2 <- data.frame(Data2, x6beta_pib_ct2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_pib_ct2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

graph_beta_pib_ct2_alt <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do PIB na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

df2 <- data.frame(Data2, x6beta_cambio_ct2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_cambio_ct2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Câmbio na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

graph_beta_cambio_ct2_alt <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do Câmbio na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

df2 <- data.frame(Data2, x6beta_ipca_ct2)
names(df2) <- c("Data", "p5", "p25", "media", "p75", "p95")
 
graph_beta_ipca_ct2 <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            #geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2

graph_beta_ipca_ct2_alt <- ggplot(data = df2, aes(Data,media)) +
            geom_line(aes(y = p5), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = p25), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p75), colour = 'skyblue4', linetype = "longdash")+
            geom_line(aes(y = p95), colour = 'skyblue3', linetype = "dashed") +
            geom_line(aes(y = media), size = 0.25)+
            geom_ribbon(aes(x=Data, ymax=p25, ymin=p5), fill="skyblue3", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=media, ymin=p25), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p75, ymin=media), fill="skyblue4", alpha=.3) +
            geom_ribbon(aes(x=Data, ymax=p95, ymin=p75), fill="skyblue3", alpha=.3) +
            xlab("Data") + ylab("Coeficiente") + ggtitle("Coeficiente do IPCA na equação da Razão Capital-Trabalho") +
            scale_y_continuous(breaks = number_ticks(10)) +
            scale_x_date(breaks = Data2[datemarks], name = "Data", labels = date_format("%Y"))+
            geom_hline(yintercept = 0, size=0.5)+
            mytheme_baixo2
```

Primeiro os gráficos com os intervalos de 16 a 84% sem forçar o zero no eixo y:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef_ct1.pdf", width = 6, height = 8)
grid.arrange(graph_beta_swap_ct, graph_beta_pib_ct, graph_beta_cambio_ct, graph_beta_ipca_ct, ncol = 2, nrow = 2)
#dev.off()
```

Agora o mesmo gráfico mas forçando o zero a aparecer:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef_ct2.pdf", width = 6, height = 8)
grid.arrange(graph_beta_swap_ct_alt, graph_beta_pib_ct_alt, graph_beta_cambio_ct_alt, graph_beta_ipca_ct_alt, ncol = 2, nrow = 2)
#dev.off()
```

E o mesmo gráfico mas com os quantis de 5 a 95 e 25 a 75:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef_ct3.pdf", width = 6, height = 8)
grid.arrange(graph_beta_swap_ct2, graph_beta_pib_ct2, graph_beta_cambio_ct2, graph_beta_ipca_ct2, ncol = 2, nrow = 2)
#dev.off()
```

Repete o mesmo de antes, mas incluindo zero no eixo y:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Coef\\Fig-Coef_ct4.pdf", width = 6, height = 8)
grid.arrange(graph_beta_swap_ct2_alt, graph_beta_pib_ct2_alt, graph_beta_cambio_ct2_alt, graph_beta_ipca_ct2_alt, ncol = 2, nrow = 2)
#dev.off()
rm(fit1)
```

# Diagnóstico

Estou me baseando nos seguintes linkis:
* www.patricklam.org/teaching/convergence_print.pdf para traceplot, density plot, running mean plot (é o plot da iteração contra a média das observações até a iteração (ele está indo de 10 em 10 para frente na média))
* https://theoreticalecology.wordpress.com/2011/12/09/mcmc-chain-analysis-and-convergence-diagnostics-with-coda-in-r/

## Diagnósticos para as médias

Um dos diagnósticos é plotar a cadeia (usando `plot(mcmc_object)`). Ele retorna o gráfico dos valores (um gráfico de linha - quanto mais ruidoso melhor) e um traceplot que é o gráfico da distribuição. Se eu não estou enganada, os meus Betas tem distribuição à posteriori normal e falta ver a distribuição dos sigmas. Se a densidade das matrizes é inversa wishart eles tem distribuição gamma, **mas acho que não tem fórmula fechada para $\Sigma$ - preciso ver no artigo do Primeri depois.**

Outro diagnóstico das médias envolve fazer o gráfico da média usando uma janela móvel para ver se a posteriori cai em alguma região e fica empacada.

Como eu tenho muitos instantes de tempo (e portanto uma quantidade enorme de betas e de sigmas), eu selecionei arbitrariamente 15 betas (que é a divisão inteira de `t` por 10 - então estou plotando 10% dos parâmetros para cada $y$). Esses gráficos eu resolvi deixar de fora do artigo.

```{r, warning = FALSE, message = FALSE, echo = FALSE}
#sequencia <-  seq(10, dim(beta_ct)[2], 20)[-1]

sequencia <- head(seq(10, dim(beta_ct)[2], 20),-1)
sequencia2 <- seq(1:dim(beta_ct)[1])

#####################################
# Para a razão capital trabalho
#####################################

#############
# Betas
#############

# Traceplot e density plots
for (i in sequencia){
  plot(mcmc_beta_ct[,i], auto.layout = T, main = paste("Beta em t=", as.character(i), "da Razão Cap./Trab."))
}

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct10.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
#dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct30.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct50.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct70.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct90.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct110.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct130.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct150.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct170.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct190.pdf", width = 6, height = 3)
plot(mcmc_beta_ct[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
# #dev.off()


# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,mcmc_beta_ct[,i])
  names(df1) <- c("Iteracao", "Beta")
  p1 <- ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw()
  p1
} 

i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_beta_ct[,i])
  names(df1) <- c("Iteracao", "Beta")
  p1 <- ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ct190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

#par(old.par)

##############
# Volatilidade
##############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_sd_ct[,i], auto.layout = T, main = paste("D.P. em t=", as.character(i), "da Razão Cap./Trab."))
}
#par(old.par)  

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct10.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct30.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct50.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct70.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct90.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct110.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct130.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct150.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct170.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct190.pdf", width = 6, height = 3)
plot(mcmc_sd_ct[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
# #dev.off()


# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,sqrt(mcmc_sd_ct[,i]))
  names(df1) <- c("Iteracao", "DP")
  ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) do desvio padrão para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)

#sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_sd_ct[,i])
  names(df1) <- c("Iteracao", "DP")
  p1 <- ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) do desv.pad. para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ct190-2.pdf", width = 3, height = 3)
  p1
# #dev.off()

#####################################
# Para a swap
#####################################

#############
# Betas
#############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_beta_swap[,i], auto.layout = T, main = paste("Beta em t=", as.character(i), "do Swap"))
}
#par(old.par) 

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap10.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap30.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap50.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap70.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap90.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap110.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap130.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap150.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap170.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap190.pdf", width = 6, height = 3)
plot(mcmc_beta_swap[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
# #dev.off()


# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,mcmc_beta_swap[,i])
  names(df1) <- c("Iteracao", "Beta")
  ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)


sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_beta_swap[,i])
  names(df1) <- c("Iteracao", "Beta")
  p1 <- ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_swap190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

##############
# Volatilidade
##############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_sd_swap[,i], auto.layout = T, main = paste("D.P. em t=", as.character(i), "do Swap"))
}
#par(old.par)  


# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap10.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap30.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap50.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap70.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap90.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap110.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap130.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap150.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap170.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap190.pdf", width = 6, height = 3)
plot(mcmc_sd_swap[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
# #dev.off()

# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,sqrt(mcmc_sd_swap[,i]))
  names(df1) <- c("Iteracao", "DP")
  ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) do desvio padrão para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)

sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_sd_swap[,i])
  names(df1) <- c("Iteracao", "DP")
  p1 <- ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de desv.pad. para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_swap190-2.pdf", width = 3, height = 3)
  p1
# #dev.off()


#####################################
# Para o PIB
#####################################

#############
# Betas
#############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_beta_pib[,i], auto.layout = T, main = paste("Beta em t=", as.character(i), "do PIB"))
}
#par(old.par) 

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib10.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib30.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib50.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib70.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib90.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib110.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib130.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib150.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib170.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib190.pdf", width = 6, height = 3)
plot(mcmc_beta_pib[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
##dev.off()


# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,mcmc_beta_pib[,i])
  names(df1) <- c("Iteracao", "Beta")
  ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)


sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_beta_pib[,i])
  names(df1) <- c("Iteracao", "Beta")
  p1 <- ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_pib190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

##############
# Volatilidade
##############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_sd_pib[,i], auto.layout = T, main = paste("D.P. em t=", as.character(i), "do PIB"))
}
#par(old.par)  

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib10.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
##dev.off()
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib30.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
##dev.off()
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib50.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
##dev.off()
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib70.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
##dev.off()
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib90.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
##dev.off()
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib110.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib130.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib150.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib170.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib190.pdf", width = 6, height = 3)
plot(mcmc_sd_pib[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
# #dev.off()


# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,sqrt(mcmc_sd_pib[,i]))
  names(df1) <- c("Iteracao", "DP")
  ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) do desvio padrão para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)

sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_sd_pib[,i])
  names(df1) <- c("Iteracao", "DP")
  p1 <- ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de desv.pad. para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_pib190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

#####################################
# Para o Câmbio
#####################################

#############
# Betas
#############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_beta_cambio[,i], auto.layout = T, main = paste("Beta em t=", as.character(i), "do Câmbio"))
}
#par(old.par)  

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio10.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio30.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio50.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio70.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio90.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio110.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio130.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio150.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio170.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio190.pdf", width = 6, height = 3)
plot(mcmc_beta_cambio[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
##dev.off()

# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,mcmc_beta_cambio[,i])
  names(df1) <- c("Iteracao", "Beta")
  ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)


sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_beta_cambio[,i])
  names(df1) <- c("Iteracao", "Beta")
  p1 <- ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_cambio190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

##############
# Volatilidadess
##############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_sd_cambio[,i], auto.layout = T, main = paste("D.P. em t=", as.character(i), "do Câmbio"))
}
#par(old.par)  

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio10.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio30.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio50.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio70.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio90.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio110.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio130.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio150.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio170.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio190.pdf", width = 6, height = 3)
plot(mcmc_sd_cambio[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
##dev.off()



# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,sqrt(mcmc_sd_cambio[,i]))
  names(df1) <- c("Iteracao", "DP")
  ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) do desvio padrão para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)

sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_sd_cambio[,i])
  names(df1) <- c("Iteracao", "DP")
  p1 <- ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de desv.pad. para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_cambio190-2.pdf", width = 3, height = 3)
  p1
##dev.off()



#####################################
# Para a IPCA
#####################################

#############
# Betas
#############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_beta_ipca[,i], auto.layout = T, main = paste("Beta em t=", as.character(i), "do IPCA"))
}
#par(old.par)

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca10.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca30.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca50.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca70.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca90.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca110.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca130.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca150.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca170.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca190.pdf", width = 6, height = 3)
plot(mcmc_beta_ipca[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
##dev.off()


# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,mcmc_beta_ipca[,i])
  names(df1) <- c("Iteracao", "Beta")
  ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)

sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_beta_ipca[,i])
  names(df1) <- c("Iteracao", "Beta")
  p1 <- ggplot(df1, aes(Iteracao, Beta)) +
    geom_line(aes(y = rollmean(Beta, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de Beta para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_beta_ipca190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

##############
# Volatilidade
##############

# Traceplot e density plots
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  plot(mcmc_sd_ipca[,i], auto.layout = T, main = paste("D.P. em t=", as.character(i), "do IPCA"))
}
#par(old.par)  

# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca10.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[1]], auto.layout = T, main = paste("t=", as.character(sequencia[1])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca30.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[2]], auto.layout = T, main = paste("t=", as.character(sequencia[2])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca50.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[3]], auto.layout = T, main = paste("t=", as.character(sequencia[3])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca70.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[4]], auto.layout = T, main = paste("t=", as.character(sequencia[4])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca90.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[5]], auto.layout = T, main = paste("t=", as.character(sequencia[5])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca110.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[6]], auto.layout = T, main = paste("t=", as.character(sequencia[6])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca130.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[7]], auto.layout = T, main = paste("t=", as.character(sequencia[7])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca150.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[8]], auto.layout = T, main = paste("t=", as.character(sequencia[8])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca170.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[9]], auto.layout = T, main = paste("t=", as.character(sequencia[9])))
# #dev.off()
# #pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca190.pdf", width = 6, height = 3)
plot(mcmc_sd_ipca[,sequencia[10]], auto.layout = T, main = paste("t=", as.character(sequencia[10])))
##dev.off()

# Gráfico da média com janela móvel
#old.par <- par(mfrow=c(5,3))
for (i in sequencia){
  df1 <- data.frame(sequencia2,sqrt(mcmc_sd_ipca[,i]))
  names(df1) <- c("Iteracao", "DP")
  ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) do desvio padrão para t=", as.character(i))) +
    theme_bw()
} 
#par(old.par)

sequencia <- c(10,30,50,70,90,110,130,150,170,190)
i <- sequencia[10]
i
  df1 <- data.frame(sequencia2,mcmc_sd_ipca[,i])
  names(df1) <- c("Iteracao", "DP")
  p1 <- ggplot(df1, aes(Iteracao, DP)) +
    geom_line(aes(y = rollmean(DP, 10, na.pad = TRUE))) +
    scale_y_continuous(name = paste("Média móvel (10 valores) de desv.pad. para t=", as.character(i))) +
    theme_bw() + theme(axis.title.y = element_text(size = 8))

##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_diag_sd_ipca190-2.pdf", width = 3, height = 3)
  p1
##dev.off()

```

Agora tem o `cumuplot()` que faz o gráfico dos quantis da cadeia (de forma acumulada). O default é 0.025, 0.5, 0.975. **Se eu tiver tempo depois, vou mexer no layout desses gráficos pois são feiosos demais.** Também deixei de fora.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#####################################
# Para a razão capital trabalho
#####################################

#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
#}
#par(old.par)

# Para os pdf
i <- sequencia[1]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct10.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[2]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct30.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[3]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct50.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[4]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct70.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[5]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct90.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[6]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct110.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[7]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct130.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[8]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct150.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[9]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct170.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[10]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct190.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()


#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis do D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#}
#par(old.par) 

i <- sequencia[1]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct10.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
##dev.off()

i <- sequencia[2]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct30.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[3]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct50.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[4]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct70.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[5]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct90.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[6]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct110.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[7]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct130.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[8]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_sd_ct150.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis do D.P. em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[9]
##pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct170.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

i <- sequencia[10]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_ct190.pdf", width = 6, height = 3)
cumuplot(mcmc_sd_ct[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "da Razão Cap./Trab."))
#dev.off()

#####################################
# Para a swap
#####################################

#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#}
#par(old.par) 

i <- sequencia[1]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap10.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[2]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap30.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[3]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap50.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[4]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap70.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[5]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap90.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[6]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap110.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[7]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap130.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[8]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap150.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[9]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap170.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()

i <- sequencia[10]
#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_cumu_beta_swap190.pdf", width = 6, height = 3)
cumuplot(mcmc_beta_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Swap"))
#dev.off()


#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_sd_swap[1:tamanho,i], auto.layout = F, main = paste("Quantis do D.P. em t=", as.character(i), "do Swap"))
#}
#par(old.par) 

#####################################
# Para o pib
#####################################

#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_beta_pib[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do PIB"))
#}
#par(old.par) 


#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_sd_pib[1:tamanho,i], auto.layout = F, main = paste("Quantis do D.P. em t=", as.character(i), "do PIB"))
#}
#par(old.par)

#####################################
# Para o Câmbio
#####################################

#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_beta_cambio[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do Câmbio"))
#}
#par(old.par) 


#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_sd_cambio[1:tamanho,i], auto.layout = F, main = paste("Quantis do D.P. em t=", as.character(i), "do Câmbio"))
#}
#par(old.par)

#####################################
# Para o IPCA
#####################################

#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_beta_ipca[1:tamanho,i], auto.layout = F, main = paste("Quantis de Beta em t=", as.character(i), "do IPCA"))
#}
#par(old.par) 


#old.par <- par(mfrow=c(5,3))
#for (i in sequencia){
#  cumuplot(mcmc_sd_ipca[1:tamanho,i], auto.layout = F, main = paste("Quantis do D.P. em t=", as.character(i), "do IPCA"))
#}
#par(old.par)

```

Por fim, tem o diagnóstico do Geweke, que calcula uma estatística com distribuição normal e que compara o início e o final da distribuição. De novo vou plotar só uma parte para não ficar muito grande. E deixei de fora do artigo

```{r, warning = FALSE, message = FALSE, echo = FALSE}
frac1. <- .3
frac2. <- .3

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_beta_ct.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_beta_ct[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05, auto.layout = F) # ele preenche em linha e depois colunas
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_beta_swap.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_beta_swap[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_beta_pib.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_beta_pib[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_beta_cambio.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_beta_cambio[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_beta_ipca.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_beta_ipca[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_sd_ct.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_sd_ct[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()


#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_sd_swap.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_sd_swap[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_sd_pib.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_sd_pib[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_sd_cambio.pdf", width = 12, height = 6)

old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_sd_cambio[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05, auto.layout = F)
par(old.par)
#dev.off()

#pdf(file = "C:\\Users\\aisha\\Documents\\Var da Aisha\\Figuras\\Diagnóstico\\Fig_geweke_sd_ipca.pdf", width = 12, height = 6)
old.par <- par(mfrow=c(5,2), mar=c(2,2,1.2,1.2))  # direita, baixo, cima, esquerda
geweke.plot(mcmc_sd_ipca[,sequencia], frac1 = frac1., frac2 = frac2., pvalue = 0.05)
par(old.par)
#dev.off()

```

## Diagnóstico da autocorrelação

O bloco abaixo eu montei para entender melhor o que a `autocorr()` do pacote `coda` faz. No fim, vou ficar com a função de autocorrelação (não a parcial) pois ela avalia o efeito até o instante `j`. (o bloco agora está oculto)

```{r, eval = FALSE, echo = FALSE, message=FALSE, warning = FALSE}
# Tentando descobrir o que as coisas são
# Esse é o do coda, ele é o mais parecido com a acf, mas não chega a ser igual.
autocorr(mcmc_sd_ct[,i], lags = c(20,100,1000))

c(acf(mcmc_sd_ct[,1], lag.max = 20, plot = F)[20]$acf,acf(mcmc_sd_ct[,1], lag.max = 100, plot = F)[100]$acf, acf(mcmc_sd_ct[,1], lag.max = 1000, plot = F)[1000]$acf)
c(Acf(mcmc_sd_ct[,1], lag.max = 20, plot = F, type = "correlation")[20]$acf, Acf(mcmc_sd_ct[,1], lag.max = 100, plot = F, type = "correlation")[100]$acf, Acf(mcmc_sd_ct[,1], lag.max = 1000, plot = F, type = "correlation")[1000]$acf)

# Esse não é parecido com ninguém
c(Acf(mcmc_sd_ct[,1], lag.max = 20, plot = F, type = "covariance")[20]$acf, Acf(mcmc_sd_ct[,1], lag.max = 100, plot = F, type = "covariance")[100]$acf, Acf(mcmc_sd_ct[,1], lag.max = 1000, plot = F, type = "covariance")[1000]$acf)


# Esses 3 são iguais
# Function Pacf computes (and by default plots) an estimate of the partial autocorrelation function of a (possibly multivariate) time series
# Aviso sobre as funções Acf e Pacf: The functions improve the acf, pacf and ccf functions. The main differences are that Acf does not plot a spike at lag 0 when type=="correlation" (which is redundant) and the horizontal axes show lags in time units rather than seasonal units..
c(pacf(mcmc_sd_ct[,1], lag.max = 20, plot = F)[20]$acf,pacf(mcmc_sd_ct[,1], lag.max = 100, plot = F)[100]$acf, pacf(mcmc_sd_ct[,1], lag.max = 1000, plot = F)[1000]$acf)
c(Acf(mcmc_sd_ct[,1], lag.max = 20, plot = F, type = "partial")[20]$acf, Acf(mcmc_sd_ct[,1], lag.max = 100, plot = F, type = "partial")[100]$acf, Acf(mcmc_sd_ct[,1], lag.max = 1000, plot = F, type = "partial")[1000]$acf)
c(Pacf(mcmc_sd_ct[,1], lag.max = 20, plot = F)[20]$acf, Pacf(mcmc_sd_ct[,1], lag.max = 100, plot = F)[100]$acf, Pacf(mcmc_sd_ct[,1], lag.max = 1000, plot = F)[1000]$acf)
```

Agora estou calculando a função te autocorrelação para depois fazer uns fancy graphs. O bloco do código está oculto.

```{r, warning = FALSE, message = FALSE, echo = FALSE}
autocorrelacao_beta_ct <- vector()
autocorrelacao_beta_swap <- vector()
autocorrelacao_beta_pib <- vector()
autocorrelacao_beta_cambio <- vector()
autocorrelacao_beta_ipca <- vector()

autocorrelacao_sd_ct <- vector()
autocorrelacao_sd_swap <- vector()
autocorrelacao_sd_pib <- vector()
autocorrelacao_sd_cambio <- vector()
autocorrelacao_sd_ipca <- vector()

pm <- proc.time()
for (i in 1:dim(mcmc_beta_ct)[2]) {
    autocorrelacao_beta_ct <- cbind(autocorrelacao_beta_ct, autocorr(mcmc_beta_ct[,i], lags = c(20,100,1000)))
    autocorrelacao_beta_swap <- cbind(autocorrelacao_beta_swap, autocorr(mcmc_beta_swap[,i], lags = c(20,100,1000)))
    autocorrelacao_beta_pib <- cbind(autocorrelacao_beta_pib, autocorr(mcmc_beta_pib[,i], lags = c(20,100,1000)))
    autocorrelacao_beta_cambio <- cbind(autocorrelacao_beta_cambio, autocorr(mcmc_beta_cambio[,i], lags = c(20,100,1000)))
    autocorrelacao_beta_ipca <- cbind(autocorrelacao_beta_ipca, autocorr(mcmc_beta_ipca[,i], lags = c(20,100,1000)))
    autocorrelacao_sd_ct <- cbind(autocorrelacao_sd_ct, autocorr(mcmc_sd_ct[,i], lags = c(20,100,1000)))
    autocorrelacao_sd_swap <- cbind(autocorrelacao_sd_swap, autocorr(mcmc_sd_swap[,i], lags = c(20,100,1000)))
    autocorrelacao_sd_pib <- cbind(autocorrelacao_sd_pib, autocorr(mcmc_sd_pib[,i], lags = c(20,100,1000)))
    autocorrelacao_sd_cambio <- cbind(autocorrelacao_sd_cambio, autocorr(mcmc_sd_cambio[,i], lags = c(20,100,1000)))
    autocorrelacao_sd_ipca <- cbind(autocorrelacao_sd_ipca, autocorr(mcmc_sd_ipca[,i], lags = c(20,100,1000)))
}
proc.time() - pm
```

Agora vamos para os gráficos.... a ideia é fazer algo como o Primiceri tem no anexo B (figura 9 - topo), porém dividindo por variável do VAR.

```{r, warning = FALSE, message = FALSE, echo = FALSE}
# Montando os data frames

#############################################
#############################################
# Betas
#############################################
#############################################
autocorrelacao_beta_ct <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_beta_ct))
names(autocorrelacao_beta_ct) <- c("tempo", "20", "100", "1000")
autocorrelacao_beta_ct <- melt(autocorrelacao_beta_ct, id.vars = "tempo")
autocorrelacao_beta_ct[,2] <- factor(autocorrelacao_beta_ct[,2])

autocorrelacao_beta_swap <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_beta_swap))
names(autocorrelacao_beta_swap) <- c("tempo", "20", "100", "1000")
autocorrelacao_beta_swap <- melt(autocorrelacao_beta_swap, id.vars = "tempo")
autocorrelacao_beta_swap[,2] <- factor(autocorrelacao_beta_swap[,2])

autocorrelacao_beta_pib <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_beta_pib)) 
names(autocorrelacao_beta_pib) <- c("tempo", "20", "100", "1000")
autocorrelacao_beta_pib <- melt(autocorrelacao_beta_pib, id.vars = "tempo")
autocorrelacao_beta_pib[,2] <- factor(autocorrelacao_beta_pib[,2])

autocorrelacao_beta_cambio <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_beta_cambio))
names(autocorrelacao_beta_cambio) <- c("tempo", "20", "100", "1000")
autocorrelacao_beta_cambio <- melt(autocorrelacao_beta_cambio, id.vars = "tempo")
autocorrelacao_beta_cambio[,2] <- factor(autocorrelacao_beta_cambio[,2])

autocorrelacao_beta_ipca <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_beta_ipca))
names(autocorrelacao_beta_ipca) <- c("tempo", "20", "100", "1000")
autocorrelacao_beta_ipca <- melt(autocorrelacao_beta_ipca, id.vars = "tempo")
autocorrelacao_beta_ipca[,2] <- factor(autocorrelacao_beta_ipca[,2])

#############################################
#############################################
# Volatilidade
#############################################
#############################################
autocorrelacao_sd_ct <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_sd_ct))
names(autocorrelacao_sd_ct) <- c("tempo", "20", "100", "1000")
autocorrelacao_sd_ct <- melt(autocorrelacao_sd_ct, id.vars = "tempo")
autocorrelacao_sd_ct[,2] <- factor(autocorrelacao_sd_ct[,2])

autocorrelacao_sd_swap <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_sd_swap))
names(autocorrelacao_sd_swap) <- c("tempo", "20", "100", "1000")
autocorrelacao_sd_swap <- melt(autocorrelacao_sd_swap, id.vars = "tempo")
autocorrelacao_sd_swap[,2] <- factor(autocorrelacao_sd_swap[,2])

autocorrelacao_sd_pib <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_sd_pib)) 
names(autocorrelacao_sd_pib) <- c("tempo", "20", "100", "1000")
autocorrelacao_sd_pib <- melt(autocorrelacao_sd_pib, id.vars = "tempo")
autocorrelacao_sd_pib[,2] <- factor(autocorrelacao_sd_pib[,2])

autocorrelacao_sd_cambio <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_sd_cambio))
names(autocorrelacao_sd_cambio) <- c("tempo", "20", "100", "1000")
autocorrelacao_sd_cambio <- melt(autocorrelacao_sd_cambio, id.vars = "tempo")
autocorrelacao_sd_cambio[,2] <- factor(autocorrelacao_sd_cambio[,2])

autocorrelacao_sd_ipca <- data.frame(1:(length(ini_xax:tempo)), t(autocorrelacao_sd_ipca))
names(autocorrelacao_sd_ipca) <- c("tempo", "20", "100", "1000")
autocorrelacao_sd_ipca <- melt(autocorrelacao_sd_ipca, id.vars = "tempo")
autocorrelacao_sd_ipca[,2] <- factor(autocorrelacao_sd_ipca[,2])

minimo_betas <- min(autocorrelacao_beta_ct[,3], autocorrelacao_beta_swap[,3], autocorrelacao_beta_pib[,3], autocorrelacao_beta_cambio[,3], autocorrelacao_beta_ipca[,3])
maximo_betas <- max(autocorrelacao_beta_ct[,3], autocorrelacao_beta_swap[,3], autocorrelacao_beta_pib[,3], autocorrelacao_beta_cambio[,3], autocorrelacao_beta_ipca[,3])

minimo_sd <- min(autocorrelacao_sd_ct[,3], autocorrelacao_sd_swap[,3], autocorrelacao_sd_pib[,3], autocorrelacao_sd_cambio[,3], autocorrelacao_sd_ipca[,3])
maximo_sd <- max(autocorrelacao_sd_ct[,3], autocorrelacao_sd_swap[,3], autocorrelacao_sd_pib[,3], autocorrelacao_sd_cambio[,3], autocorrelacao_sd_ipca[,3])

#############################################
#############################################
# Gráficos
#############################################
#############################################

##################### BETAS ########################

########################
# Razão capital trabalho
########################
p1a <- ggplot(autocorrelacao_beta_ct, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="Razão Cap./Trab.", lim = c(minimo_betas,maximo_betas)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p1a <- p1a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="top", legend.text = element_text(size = 8), legend.title = element_text(size = 8), axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.05,0.1,0.1), "cm"))
p1a <- p1a + labs(linetype = "Lags") # I couldn't fix the legend name properly, so why not use a gambiarra?
p1a <- p1a + labs(colour='Lags')

########################
# swap
########################
p2a <- ggplot(autocorrelacao_beta_swap, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="Swap", lim = c(minimo_betas,maximo_betas)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p2a <- p2a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="top", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.05,0.1,0.1), "cm"))
p2a <- p2a + labs(linetype = "Lags") 
p2a <- p2a + labs(colour='Lags')

########################
# PIB
########################
p3a <- ggplot(autocorrelacao_beta_pib, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="PIB", lim = c(minimo_betas,maximo_betas)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p3a <- p3a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="right", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.05,0.1,0.1), "cm"))
p3a <- p3a + labs(linetype = "Lags") 
p3a <- p3a + labs(colour='Lags')

########################
# cambio
########################
p4a <- ggplot(autocorrelacao_beta_cambio, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="Câmbio", lim = c(minimo_betas,maximo_betas)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p4a <- p4a + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="top", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.05,0.1,0.1), "cm"))
p4a <- p4a + labs(linetype = "Lags") 
p4a <- p4a + labs(colour='Lags')

########################
# ipca
########################
p5a <- ggplot(autocorrelacao_beta_ipca, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="IPCA", lim = c(minimo_betas,maximo_betas)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p5a <- p5a + theme(axis.text.x = element_text(angle=25, vjust = 2, size = 5, hjust = 1), axis.title.x = element_text(size = 6, vjust = 5), axis.title.y = element_text(size =6), legend.position="right", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.05,0.0001,0.1), "cm")) # cima,direita, baixo, esquerda)
p5a <- p5a + labs(linetype = "Lags") # I couldn't fix the legend name properly, so why not?
p5a <- p5a + labs(colour='Lags')

#grid.draw(rbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a), ggplotGrob(p4a), ggplotGrob(p5a), size = "first"))

################## VOLATILIDADE ######################


########################
# Razão capital trabalho
########################
p1 <- ggplot(autocorrelacao_sd_ct, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=T, aes(linetype = variable))+
        scale_y_continuous(name="Razão Cap./Trab.", lim = c(minimo_sd,maximo_sd)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p1 <- p1 + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="top", legend.text = element_text(size = 8), legend.title = element_text(size = 8), axis.text.y = element_text(size = 6), legend.key.size = unit(.5, "cm"), plot.margin = unit(c(0.009,0.08,0.1,0.1), "cm"))
p1 <- p1 + labs(linetype = "Lags") # I couldn't fix the legend name properly, so why not use a gambiarra?
p1 <- p1 + labs(colour='Lags')

########################
# swap
########################

p2 <- ggplot(autocorrelacao_sd_swap, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="Swap", lim = c(minimo_sd,maximo_sd)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p2 <- p2 + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="top", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.08,0.1,0.1), "cm"))
p2 <- p2 + labs(linetype = "Lags") 
p2 <- p2 + labs(colour='Lags')

########################
# PIB
########################

p3 <- ggplot(autocorrelacao_sd_pib, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="PIB", lim = c(minimo_sd,maximo_sd)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p3 <- p3 + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="right", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.08,0.1,0.1), "cm"))
p3 <- p3 + labs(linetype = "Lags") 
p3 <- p3 + labs(colour='Lags')

########################
# cambio
########################

p4 <- ggplot(autocorrelacao_sd_cambio, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="Câmbio", lim = c(minimo_sd,maximo_sd)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() +
        scale_colour_brewer(palette="Set1")
        
p4 <- p4 + theme(axis.text.x=element_blank(), axis.title.x = element_blank(), axis.title.y = element_text(size = 6), legend.position="top", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.08,0.1,0.1), "cm")) # cima,direita, baixo, esquerda)
p4 <- p4 + labs(linetype = "Lags") 
p4 <- p4 + labs(colour='Lags')

########################
# ipca
########################

p5 <- ggplot(autocorrelacao_sd_ipca, aes(tempo, value, colour = variable)) +
        geom_line(alpha = 1, show.legend=F, aes(linetype = variable))+
        scale_y_continuous(name="IPCA", lim = c(minimo_sd,maximo_sd)) +
        scale_x_continuous(name = "Tempo", breaks = seq(0,tempo,10), expand = c(0,0)) +
        theme_bw() + 
        scale_colour_brewer(palette="Set1")
        
p5 <- p5 + theme(axis.text.x = element_text(angle=25, vjust = 2, size = 5, hjust = 1), axis.title.x = element_text(size = 6, vjust = 5), axis.title.y = element_text(size =6), legend.position="right", axis.text.y = element_text(size = 6), plot.margin = unit(c(0.009,0.08,0.0001,0.1), "cm")) # cima,direita, baixo, esquerda
p5 <- p5 + labs(linetype = "Lags") # I couldn't fix the legend name properly, so why not?
p5 <- p5 + labs(colour='Lags')

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig-corr.pdf", width = 12, height = 6)
ggarrange(p1a, p1, p2a, p2, p3a, p3, p4a, p4, p5a, p5, common.legend = TRUE, ncol = 2, nrow = 5)
#dev.off()
```

## Diagnóstico multivariado

A estatística de Gelman-Rubin mede se há diferença significativa entre a variância dentro e entre diversas cadeias utilizando um fator de redução de escala. Aqui eu optei por simular duas cadeias e fazer a comparação entre elas. Em função da memória do computador eu utilizei um número menor de iterações salvas: ao invés de salvar todos os valores, armazenei apenas os 10.000 últimos valores (20%).

```{r, message = FALSE, warning = FALSE, echo = FALSE}
# Primeira coisa é limpar a memória
#keep(capital_trabalho_final, swap, PIB2, cambio, ipca, pos_ct, pos_ipca, pos_cambio, pos_swap, pos_pib, sure = TRUE) 
#rm(fit1) 
# Junta o swap com a selic
selic_trim <- ts(selic_final[1:44], start = c(1996, 01, 01), frequency = 12)

# Binding the series
comb <- ts.union(selic_trim, swap90)
swap <- pmin(comb[,1], comb[,2], na.rm = TRUE)

#Inflação - Produto - Juros - Câmbio - Desigualdade.
var1 <- cbind(capital_trabalho_final*100, ipca, PIB*100, swap, cambio) # The bvar function does not allows data.frames
names(var1) <- c("capital_trabalho", "ipca", "pib", "swap", "cambio")

pos_ct     <- grep("capital_trabalho", names(var1))
pos_swap   <- grep("swap", names(var1))
pos_pib    <- grep("pib", names(var1))
pos_cambio <- grep("cambio", names(var1))
pos_ipca   <- grep("ipca", names(var1))

set.seed(6969)

nburn.    <- 1000000 # Burn the first 350k replications
nrep.     <- 100000 # Estimate another 100k times after burn in
thinfac.  <- 4 # But keep only 1 in 4 estimates
p.        <- 1 # Number of lags
tau.      <- 48-p. # Number of observations to use as prior
nf.       <- 1 # Number of forecast periods
k_B.      <- 6 # Fator de inflação na priori
k_A.      <- 4 # Fator de inflação na priori

# No idead what's this for
tamanho <- floor(1/thinfac.*nrep.)
# número de tempos
tempo <- nrow(var1)

set.seed(6969)
pm <- proc.time()
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., nf = nf., thinfac = thinfac.)
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fita.rds")
proc.time() - pm
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fita.rds")


betas_ct     <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_ct)
betas_swap   <- parameter.draws(fit1, type = "lag1", row = pos_swap, col = pos_swap)
betas_pib    <- parameter.draws(fit1, type = "lag1", row = pos_pib, col = pos_pib)
betas_cambio <- parameter.draws(fit1, type = "lag1", row = pos_cambio, col = pos_cambio)
betas_ipca   <- parameter.draws(fit1, type = "lag1", row = pos_ipca, col = pos_ipca)

sd_ct        <- parameter.draws(fit1, type = "vcv", row = pos_ct, col = pos_ct)
sd_swap      <- parameter.draws(fit1, type = "vcv", row = pos_swap, col = pos_swap)
sd_pib       <- parameter.draws(fit1, type = "vcv", row = pos_pib, col = pos_pib)
sd_cambio    <- parameter.draws(fit1, type = "vcv", row = pos_cambio, col = pos_cambio)
sd_ipca      <- parameter.draws(fit1, type = "vcv", row = pos_ipca, col = pos_ipca)

mcmc_1 <- mcmc(cbind(betas_ct, betas_swap, betas_pib, betas_cambio, betas_ipca, sd_ct, sd_swap, sd_pib, sd_cambio, sd_ipca))

rm(fit1, betas_ct, betas_swap, betas_pib, betas_cambio, betas_ipca, sd_ct, sd_swap, sd_pib, sd_cambio, sd_ipca)

set.seed(9696)
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fitb.rds")
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., nf = nf., thinfac = thinfac.)
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fitb.rds")

betas_ct     <- parameter.draws(fit1, type = "lag1", row = pos_ct, col = pos_ct)
betas_swap  <- parameter.draws(fit1, type = "lag1", row = pos_swap, col = pos_swap)
betas_pib    <- parameter.draws(fit1, type = "lag1", row = pos_pib, col = pos_pib)
betas_cambio <- parameter.draws(fit1, type = "lag1", row = pos_cambio, col = pos_cambio)
betas_ipca   <- parameter.draws(fit1, type = "lag1", row = pos_ipca, col = pos_ipca)

sd_ct        <- parameter.draws(fit1, type = "vcv", row = pos_ct, col = pos_ct)
sd_swap     <- parameter.draws(fit1, type = "vcv", row = pos_swap, col = pos_swap)
sd_pib       <- parameter.draws(fit1, type = "vcv", row = pos_pib, col = pos_pib)
sd_cambio    <- parameter.draws(fit1, type = "vcv", row = pos_cambio, col = pos_cambio)
sd_ipca      <- parameter.draws(fit1, type = "vcv", row = pos_ipca, col = pos_ipca)

mcmc_2 <- mcmc(cbind(betas_ct, betas_swap, betas_pib, betas_cambio, betas_ipca, sd_ct, sd_swap, sd_pib, sd_cambio, sd_ipca))

rm(fit1, betas_ct, betas_swap, betas_pib, betas_cambio, betas_ipca, sd_ct, sd_swap, sd_pib, sd_cambio, sd_ipca)

lista <- mcmc.list(mcmc_1, mcmc_2)
diagnostico <- gelman.diag(lista)
tail(diagnostico)
#nrow(diagnostico$psrf) #2140 linhas

df1 <- data.frame(seq(1, nrow(diagnostico$psrf), 1) , diagnostico$psrf[,1], diagnostico$psrf[,2])
names(df1) <- c("parametro", "gelman", "upperic")

df2 <- melt(df1, id.vars = "parametro")

p1 <- ggplot(df1, aes(x = parametro, y = gelman))+
  geom_line()

cores <- brewer.pal(6, "Dark2")

p2 <- ggplot(data = df1, aes(parametro)) +
 geom_line(aes(y=gelman, colour = "Gelman"), linetype = "solid", show.legend = F) +
 geom_line(aes(y=upperic, colour = "IC95%"), linetype = "dashed", show.legend = F)+
 scale_y_continuous(name="Coeficiente de Brooks & Gellman (IC95%)")+
 scale_x_continuous(name = "Parâmetro")+
 labs(color = "Variável")+
 scale_colour_manual("Variável", breaks = c("Gelmann", "IC95%"), values = c(cores[3], cores[6]))+
 theme_bw()+
 theme(axis.text.x = element_text(angle=30, hjust = 1, size = 7), axis.title.x = element_text(size = 7), axis.title.y = element_text(size = 7))

#pdf(file = "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Imagens\\Fig_brooks.pdf", width = 6, height = 3)
p2
#dev.off()

head(df2)
#gelman.plot(lista)

# Tentar descobrir como colocar label no gelman plot
rm(fit1)
```

# Previsão

Fiz previsão $nf = 1, 6, 12, 24$ passos à frente.

O funcionamento do algoritmo the previsão é o seguinte:

1. Para cada uma das iterações MCMC (no meu caso, $\ell = 1, \ldots, 100.000$);
    a. Simula a trajetória dos parâmetros para $nf$ períodos à frente, baseado na iteração atual $\ell$;
    b. Simula os vetores de erros $\varepsilon_{T+j}$, $j=1, \ldots, nf$ a partir de uma normal;
    c. Usa os parâmetros e erros para simular observações previstas usando o processo gerador dos dados que está no início do documento;
    d. Para cada período $j = 1, \ldots, nf$ calcula o vetor de médias e a matriz de variâncias e covariâncias condicional aos parâmetros simulados até $T+j$.
2. "Encolhe as observações": fica com uma em cada `thinfac` observações (aqui usei uma em 4);
3.  Entrega os resultados:
    * `fc.ydraws` é um objeto de dimensão `[5 \times nf \times 25.000]` (5 variáveis no var, nf é o número de períodos previsto e 25.000 são o número de observações que eu guardo das 100.000 simulações). Por exemplo, `fc.ydraws[1,3,]` contém todas as repetições da primeira variável do VAR, 3 períodos à frente;
    * `fc.mdraws` contém as médias (que que é isso?) condicionais aos parâmetrs. Seu tamanho é o mesmo de `fc.ydraws`;
    * `fc.vdraws` contém as variâncias previstas, $V_{T+j}^{(\ell)}$ e tem tamanho $[0.5\cdot 5 \cdot (5+1) \times nf \times 25000]$. Por exemplo, `fc.vdraws[,1,1]` contém os elementos empilhados de $V_{T+1}^{(1)}$ e é a primeira amostra das matriz de variância e covariância para todas variáveis, um período à frente.

## Medidas de erro de previsão usadas

A primeira coisa é implementar uma função para calcular o [MASE](https://robjhyndman.com/papers/mase.pdf) (_mean absolute scaled error_). Defina o termo de erro de um passo à frente como $e_t = y_t - \hat{y}_t$. Então, podemos definir um erro padronizado como

$$q_t = \frac{e_t}{\frac{1}{n-1}\sum\limits_{i=2}^n |y_i - y_{i-1}|},$$
que é independente da escala dos dados das séries. Então, o erro absoluto padronizado médio (algumas pessoas traduzem como escalado ou escalar, eu achei feio demais) é definido por

$$\text{MASE} = \text{média }(|q_t|)$$

Além desse, vou calcular também outras 2 medidas comuns, MAPE (erro médio percentual absoluto) e o MSE (erro quadrático médio). Esses estão implementados no R dentro do pacote `DescTools`.

Então vou fazer umas funções auxiliares para calcular o MASE e também para juntar os resultados em uma tabelinha.

```{r, warning = FALSE, message = FALSE}
# O denominador do MASE é fixo, então vou calcular ele separadamente
# Como eu junto todas as variáveis do VAR no objeto var1, vou aplicar a função sobre as colunas do var1

den_MASE <- function(serie){
  n <- length(serie)
  soma <- vector()
  for (i in 2:n){
    soma[i-1] <- abs(serie[i] - serie[i-1])
  }
  x <- sum(soma)/(n-1)
  x
}

```

## 1 passo à frente

~Posso usar o que eu já tinha estimado.~ Não posso usar o que eu tinha estimado porque eu não separei o pedaço da amostra que vai ficar de comparação.

```{r, message = FALSE, warning = FALSE}
rm(fit1)
# Previsão
#Inflação - Produto - Juros - Câmbio - Desigualdade.
var1 <- cbind(capital_trabalho_final*100, ipca, PIB*100, swap, cambio) # The bvar function does not allows data.frames
#var2 <- cbind(capital_trabalho_final, swap, PIB2, cambio, ipca) # The bvar function does not allows data.frames
names(var1) <- c("capital_trabalho", "ipca", "pib", "swap", "cambio")
#names(var1) <- c("ipca", "pib", "swap", "cambio","capital_trabalho") # Ficou uma merda

#var1 <- c(1,2,3,4,5)

pos_ct     <- grep("capital_trabalho", names(var1))
pos_swap   <- grep("swap", names(var1))
pos_pib    <- grep("pib", names(var1))
pos_cambio <- grep("cambio", names(var1))
pos_ipca   <- grep("ipca", names(var1))

nburn.    <- 1000000 # Burn the first 100kk replications
nrep.     <- 100000 # Estimate another 100k times after burn in
thinfac.  <- 4 # But keep only 1 in 4 estimates
p.        <- 1 # Number of lags
tau.      <- 48 - p. # Number of observations to use as prior
nf.       <- 1 # Number of forecast periods
k_B.      <- 6 # Fator de inflação na priori
k_A.      <- 4 # Fator de inflação na priori

# No idea what's this for
tamanho <- floor(1/thinfac.*nrep.)
# número de tempos
tempo <- nrow(var1)

# Prepara um vetor com as últimas nf. observações para deixar de fora
amostra_1 <- var1[(nrow(var1)-nf.+1):(nrow(var1)),] 
var1      <- var1[1:(nrow(var1)-nf.),]

set.seed(2747)
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit1for.rds")
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., nf = nf., thinfac = thinfac.)
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit1for.rds")
#rm(fit1)
```


```{r, warning = FALSE, message = FALSE}
# Primeiro eu monto um objeto só com a previsão
# Eu sei que essa coisa tem três dimensões e quero calcular a média da terceira dimensão e ficar com uma matriz
var1_prev <- apply(fit1$fc.ydraws, c(1,2), mean)

# Agora preciso calcular os erros de previsão em cada período
# nf é o número de períodos de previsão
# amostra1 é onde ficam guardados os valores que estou prevendo
# var1_prev é onde ficam guardados os valores que eu previ

amostra1 <- matrix(amostra_1, ncol=nf.)
erro_prev <- amostra1 - var1_prev

q_t <- erro_prev/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE)

MASE_1 <- abs(q_t)

MAPE_1 <- vector()
MSE_1  <- vector()

for (i in 1:ncol(var1)){
   MAPE_1[i] <- MAPE(x = var1_prev[i,1], ref = amostra1[i,1])
   MSE_1[i] <- MSE(x = var1_prev[i,1], ref = amostra1[i,1])
}  
  
```

Agora estimo um modelo VAR(1) simples para comparar

```{r, warning = FALSE, message = FALSE}
fit_simples <- VAR(var1, p=p.)
var_simples_prev <- predict(fit_simples, n.ahead = nf.)
vars_prev <- vector()

for (i in 1:ncol(var1)){
  vars_prev[i] <-  (var_simples_prev[[1]][[i]][1])
}

erro_simples <- amostra_1 - vars_prev

q_t <- erro_simples/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE)

MASE_1_simples <- abs(q_t)

MAPE_1_simples <- vector()
MSE_1_simples  <- vector()
vars_prev <- matrix(vars_prev, ncol = 1)
amostra_1 <- matrix(amostra_1, ncol = 1)

for (i in 1:ncol(var1)){
   MAPE_1_simples[i] <- MAPE(x = vars_prev[i,1], ref = amostra_1[i,1])
   MSE_1_simples[i] <- MSE(x = vars_prev[i,1], ref = amostra_1[i,1])
} 

```

## 6 passos à frente (1 semestre)

```{r, echo = FALSE, warning=FALSE, message=FALSE}
rm(fit1)
# Previsão
#Inflação - Produto - Juros - Câmbio - Desigualdade.
var1 <- cbind(capital_trabalho_final*100, ipca, PIB*100, swap, cambio) # The bvar function does not allows data.frames
#var2 <- cbind(capital_trabalho_final, swap, PIB2, cambio, ipca) # The bvar function does not allows data.frames
names(var1) <- c("capital_trabalho", "ipca", "pib", "swap", "cambio")
#names(var1) <- c("ipca", "pib", "swap", "cambio","capital_trabalho") # Ficou uma merda

#var1 <- c(1,2,3,4,5)

pos_ct     <- grep("capital_trabalho", names(var1))
pos_swap   <- grep("swap", names(var1))
pos_pib    <- grep("pib", names(var1))
pos_cambio <- grep("cambio", names(var1))
pos_ipca   <- grep("ipca", names(var1))

nburn.    <- 1000000 # Burn the first 100kk replications
nrep.     <- 100000 # Estimate another 100k times after burn in
thinfac.  <- 4 # But keep only 1 in 4 estimates
p.        <- 1 # Number of lags
tau.      <- 48 - p. # Number of observations to use as prior
nf.       <- 6 # Number of forecast periods
k_B.      <- 6 # Fator de inflação na priori
k_A.      <- 4 # Fator de inflação na priori

# No idea what's this for
tamanho <- floor(1/thinfac.*nrep.)
# número de tempos
tempo <- nrow(var1)

# Prepara um vetor com as últimas nf. observações para deixar de fora
amostra_1 <- var1[(nrow(var1)-nf.+1):(nrow(var1)),] 
var1      <- var1[1:(nrow(var1)-nf.),]

set.seed(2747)
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit6for.rds")
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., nf = nf., thinfac = thinfac.)
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit6for.rds")
#rm(fit1)
```

```{r, warning = FALSE, message = FALSE}
# Primeiro eu monto um objeto só com a previsão
# Eu sei que essa coisa tem três dimensões e quero calcular a média da terceira dimensão e ficar com uma matriz
var6_prev <- apply(fit1$fc.ydraws, c(1,2), mean)

# Agora preciso calcular os erros de previsão em cada período
# nf é o número de períodos de previsão
# amostra1 é onde ficam guardados os valores que estou prevendo
# var1_prev é onde ficam guardados os valores que eu previ

amostra6 <- t(amostra_1)
erro_prev <- amostra6 - var6_prev

q_t <- abs(erro_prev/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE))

MASE_6 <- apply(q_t, 1, sum)

MAPE_6 <- vector()
MSE_6  <- vector()

for (i in 1:ncol(var1)){
    MAPE_6[i] <- MAPE(x = var6_prev[i,1:nf.], ref = amostra6[i,1:nf.])
    MSE_6[i] <- MSE(x = var6_prev[i,1:nf.], ref = amostra6[i,1:nf.])
} 

```

Agora estimo um modelo VAR(1) simples para comparar

```{r, warning = FALSE, message = FALSE}
fit_simples <- VAR(var1, p=p.)
var_simples_prev <- predict(fit_simples, n.ahead = nf.)
vars_prev <- matrix(NA, ncol = ncol(var1), nrow = nf.)

for (i in 1:ncol(var1)){
  vars_prev[,i] <-  (var_simples_prev[[1]][[i]][,1])
}

erro_simples <- amostra_1 - vars_prev

q_t <- abs(erro_simples/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE))

MASE_6_simples <- apply(q_t, 2, sum)

MAPE_6_simples <- vector()
MSE_6_simples  <- vector()

for (i in 1:ncol(var1)){
   MAPE_6_simples[i] <- MAPE(x = vars_prev[1:nf.,i], ref = amostra_1[1:nf.,i])
   MSE_6_simples[i] <- MSE(x = vars_prev[1:nf.,i], ref = amostra_1[1:nf.,i])
} 

```

## 12 passos à frente (1 ano)

```{r, warning=FALSE, message=FALSE}
rm(fit1)
#Inflação - Produto - Juros - Câmbio - Desigualdade.
var1 <- cbind(capital_trabalho_final*100, ipca, PIB*100, swap, cambio) # The bvar function does not allows data.frames
#var2 <- cbind(capital_trabalho_final, swap, PIB2, cambio, ipca) # The bvar function does not allows data.frames
names(var1) <- c("capital_trabalho", "ipca", "pib", "swap", "cambio")
#names(var1) <- c("ipca", "pib", "swap", "cambio","capital_trabalho") # Ficou uma merda

#var1 <- c(1,2,3,4,5)

pos_ct     <- grep("capital_trabalho", names(var1))
pos_swap   <- grep("swap", names(var1))
pos_pib    <- grep("pib", names(var1))
pos_cambio <- grep("cambio", names(var1))
pos_ipca   <- grep("ipca", names(var1))

nburn.    <- 1000000 # Burn the first 100kk replications
nrep.     <- 100000 # Estimate another 100k times after burn in
thinfac.  <- 4 # But keep only 1 in 4 estimates
p.        <- 1 # Number of lags
tau.      <- 48 - p. # Number of observations to use as prior
nf.       <- 12 # Number of forecast periods
k_B.      <- 6 # Fator de inflação na priori
k_A.      <- 4 # Fator de inflação na priori

# No idea what's this for
tamanho <- floor(1/thinfac.*nrep.)
# número de tempos
tempo <- nrow(var1)

# Prepara um vetor com as últimas nf. observações para deixar de fora
amostra_1 <- var1[(nrow(var1)-nf.+1):(nrow(var1)),] 
var1      <- var1[1:(nrow(var1)-nf.),]

set.seed(2747)
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit12for.rds")
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., nf = nf., thinfac = thinfac.)
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit12for.rds")
#rm(fit1)
```

```{r, warning = FALSE, message = FALSE}
# Primeiro eu monto um objeto só com a previsão
# Eu sei que essa coisa tem três dimensões e quero calcular a média da terceira dimensão e ficar com uma matriz
var12_prev <- apply(fit1$fc.ydraws, c(1,2), mean)

# Agora preciso calcular os erros de previsão em cada período
# nf é o número de períodos de previsão
# amostra1 é onde ficam guardados os valores que estou prevendo
# var1_prev é onde ficam guardados os valores que eu previ

amostra12 <- t(amostra_1)
erro_prev <- amostra12 - var12_prev

q_t <- abs(erro_prev/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE))

MASE_12 <- apply(q_t, 1, sum)

MAPE_12 <- vector()
MSE_12  <- vector()

for (i in 1:ncol(var1)){
    MAPE_12[i] <- MAPE(x = var12_prev[i,1:nf.], ref = amostra12[i,1:nf.])
    MSE_12[i] <- MSE(x = var12_prev[i,1:nf.], ref = amostra12[i,1:nf.])
} 

```

Agora estimo um modelo VAR(1) simples para comparar

```{r, warning = FALSE, message = FALSE}
fit_simples <- VAR(var1, p=p.)
var_simples_prev <- predict(fit_simples, n.ahead = nf.)
vars_prev <- matrix(NA, ncol = ncol(var1), nrow = nf.)

for (i in 1:ncol(var1)){
  vars_prev[,i] <-  (var_simples_prev[[1]][[i]][,1])
}

erro_simples <- amostra_1 - vars_prev

q_t <- abs(erro_simples/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE))

MASE_12_simples <- apply(q_t, 2, sum)

MAPE_12_simples <- vector()
MSE_12_simples  <- vector()

for (i in 1:ncol(var1)){
   MAPE_12_simples[i] <- MAPE(x = vars_prev[1:nf.,i], ref = amostra_1[1:nf.,i])
   MSE_12_simples[i] <- MSE(x = vars_prev[1:nf.,i], ref = amostra_1[1:nf.,i])
} 

```

## 24 passos à frente (2 anos)

```{r, warning=FALSE, message=FALSE, eval = FALSE}
rm(fit1)
# Previsão
#Inflação - Produto - Juros - Câmbio - Desigualdade.
var1 <- cbind(capital_trabalho_final*100, ipca, PIB*100, swap, cambio) # The bvar function does not allows data.frames
#var2 <- cbind(capital_trabalho_final, swap, PIB2, cambio, ipca) # The bvar function does not allows data.frames
names(var1) <- c("capital_trabalho", "ipca", "pib", "swap", "cambio")
#names(var1) <- c("ipca", "pib", "swap", "cambio","capital_trabalho") # Ficou uma merda

#var1 <- c(1,2,3,4,5)

pos_ct     <- grep("capital_trabalho", names(var1))
pos_swap   <- grep("swap", names(var1))
pos_pib    <- grep("pib", names(var1))
pos_cambio <- grep("cambio", names(var1))
pos_ipca   <- grep("ipca", names(var1))

nburn.    <- 1000000 # Burn the first 100kk replications
nrep.     <- 100000 # Estimate another 100k times after burn in
thinfac.  <- 4 # But keep only 1 in 4 estimates
p.        <- 1 # Number of lags
tau.      <- 48 - p. # Number of observations to use as prior
nf.       <- 24 # Number of forecast periods
k_B.      <- 6 # Fator de inflação na priori
k_A.      <- 4 # Fator de inflação na priori

# No idea what's this for
tamanho <- floor(1/thinfac.*nrep.)
# número de tempos
tempo <- nrow(var1)

# Prepara um vetor com as últimas nf. observações para deixar de fora
amostra_1 <- var1[(nrow(var1)-nf.+1):(nrow(var1)),] 
var1      <- var1[1:(nrow(var1)-nf.),]

set.seed(2747)
fit1 <- readRDS("D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit24for.rds")
#fit1 <- bvar.sv.tvp(var1, p=p., tau = tau., nburn = nburn., nrep = nrep., nf = nf., thinfac = thinfac.)
#saveRDS(fit1, "D:\\Onedrive - Aisha\\OneDrive\\Documentos\\Mestrado Economia\\Dissertação\\YSI - Buenos Aires\\Testes\\fit24for.rds")
#rm(fit1)
```

```{r}
# Primeiro eu monto um objeto só com a previsão
# Eu sei que essa coisa tem três dimensões e quero calcular a média da terceira dimensão e ficar com uma matriz
var24_prev <- apply(fit1$fc.ydraws, c(1,2), mean)

# Agora preciso calcular os erros de previsão em cada período
# nf é o número de períodos de previsão
# amostra1 é onde ficam guardados os valores que estou prevendo
# var1_prev é onde ficam guardados os valores que eu previ

amostra24 <- t(amostra_1)
erro_prev <- amostra24 - var24_prev

q_t <- abs(erro_prev/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE))

MASE_24 <- apply(q_t, 1, sum)

MAPE_24 <- vector()
MSE_24  <- vector()

for (i in 1:ncol(var1)){
    MAPE_24[i] <- MAPE(x = var24_prev[i,1:nf.], ref = amostra24[i,1:nf.])
    MSE_24[i] <- MSE(x = var24_prev[i,1:nf.], ref = amostra24[i,1:nf.])
} 

```

Agora estimo um modelo VAR(1) simples para comparar

```{r, warning = FALSE, message = FALSE}
fit_simples <- VAR(var1, p=p.)
var_simples_prev <- predict(fit_simples, n.ahead = nf.)
vars_prev <- matrix(NA, ncol = ncol(var1), nrow = nf.)

for (i in 1:ncol(var1)){
  vars_prev[,i] <-  (var_simples_prev[[1]][[i]][,1])
}

erro_simples <- amostra_1 - vars_prev

q_t <- abs(erro_simples/apply(var1[((tau.+p.+1):nrow(var1)),], 2, FUN = den_MASE))

MASE_24_simples <- apply(q_t, 2, sum)

MAPE_24_simples <- vector()
MSE_24_simples  <- vector()

for (i in 1:ncol(var1)){
   MAPE_24_simples[i] <- MAPE(x = vars_prev[1:nf.,i], ref = amostra_1[1:nf.,i])
   MSE_24_simples[i] <- MSE(x = vars_prev[1:nf.,i], ref = amostra_1[1:nf.,i])
} 

```

Agora vamos juntar todo mundo numa tabelinha bonitinha. 

```{r, message = FALSE, warning = FALSE}
matrizona <- matrix(NA, ncol = ncol(var1), nrow = (2*3*4)) # 3 measures and 4 times 2 methods
colnames(matrizona) <- c("capital trabalho", "ipca", "pib", "swap", "cambio")
rownames(matrizona) <- c("MASE TVP-VAR 1", "MASE VAR 1", "MSE TVP-VAR 1", "MSE VAR 1", "MAPE TVP-VAR 1", "MAPE VAR 1", 
                         "MASE TVP-VAR 6", "MASE VAR 6", "MSE TVP-VAR 6", "MSE VAR 6", "MAPE TVP-VAR 6", "MAPE VAR 6", 
                         "MASE TVP-VAR 12", "MASE VAR 12", "MSE TVP-VAR 12", "MSE VAR 12", "MAPE TVP-VAR 12", "MAPE VAR 12",
                         "MASE TVP-VAR 24", "MASE VAR 24", "MSE TVP-VAR 24", "MSE VAR 24", "MAPE TVP-VAR 24", "MAPE VAR 24")
matrizona[1,] <- as.vector(MASE_1)

# 1 step
matrizona[1,] <- round(as.vector(MASE_1),4)
matrizona[2,] <- round(MASE_1_simples, 4)
matrizona[3,] <- round(MSE_1, 4)
matrizona[4,] <- round(MSE_1_simples, 4)
matrizona[5,] <- round(MAPE_1, 4)
matrizona[6,] <- round(MAPE_1_simples, 4)

# 6 steps
matrizona[7,] <- round(MASE_6,4)
matrizona[8,] <- round(MASE_6_simples, 4)
matrizona[9,] <- round(MSE_6, 4)
matrizona[10,] <- round(MSE_6_simples, 4)
matrizona[11,] <- round(MAPE_6, 4)
matrizona[12,] <- round(MAPE_6_simples, 4)

# 12 steps
matrizona[13,] <- round(MASE_12,4)
matrizona[14,] <- round(MASE_12_simples, 4)
matrizona[15,] <- round(MSE_12, 4)
matrizona[16,] <- round(MSE_12_simples, 4)
matrizona[17,] <- round(MAPE_12, 4)
matrizona[18,] <- round(MAPE_12_simples, 4)

# 24 steps
matrizona[19,] <- round(MASE_24,4)
matrizona[20,] <- round(MASE_24_simples, 4)
matrizona[21,] <- round(MSE_24, 4)
matrizona[22,] <- round(MSE_24_simples, 4)
matrizona[23,] <- round(MAPE_24, 4)
matrizona[24,] <- round(MAPE_24_simples, 4)

matrizona <- data.frame(matrizona)

#stargazer(matrizona, summary=FALSE, header = TRUE, type = 'latex')
stargazer(matrizona, summary=FALSE, header = TRUE, type = 'html')

```


